<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/SeaGapDocs/libs/katex/katex.min.css"> <link rel=stylesheet  href="/SeaGapDocs/libs/highlight/styles/github.min.css"> <link href="/SeaGapDocs/css/franklin.css" rel=stylesheet > <link href="/SeaGapDocs/css/vela.css" rel=stylesheet > <script src="/SeaGapDocs/libs/vela/jquery.min.js"></script> <link rel=icon  href="/SeaGapDocs/assets/favicon.png"> <title>SeaGapDocs</title> <div class="main-nav slideout-menu slideout-menu-left" id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>SeaGap Docs</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/SeaGapDocs/index.html">Home</a> <li><a href="/SeaGapDocs/install/">Installation</a> <li><a href="/SeaGapDocs/dataformat/">Dataformat</a> <li><a href="" class=has-arrow >Methodology</a> <ul> <li><a href="/SeaGapDocs/methodoverview/">Overview</a> </ul> <ul> <li><a href="/SeaGapDocs/methodtt/">Travel-time calculation</a> </ul> <ul> <li><a href="/SeaGapDocs/methodkinematic/">Kinematic array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodstatic/">Static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodsingle/">Individual transponder positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodmcmcpvg/">Static array positioning with gradients</a> </ul> <li><a href="" class=has-arrow >Tutorials</a> <ul> <li><a href="/SeaGapDocs/tutorialforward/">Forward calculation</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialdenoise/">Outlier removal</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialkinematic/">Kinematic array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialstatic/">Static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialmcmcpvg/">MCMC static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialts/">Line fitting for time-series</a> </ul> <li><a href="/SeaGapDocs/others/">Others</a> </ul> </nav> </div> <main id=panel  class="slidout-panel slideout-panel-left"> <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">Tutorials</h1> <hr> <div class=franklin-content > <h1 id=mcmc_static_array_positioning ><a href="#mcmc_static_array_positioning" class=header-anchor >MCMC static array positioning</a></h1> <div class=franklin-toc ><ol><li><a href="#make_initial_value_file">Make initial value file</a><li><a href="#run_mcmc_processing">Run MCMC processing</a><ol><li><a href="#delay_to_start_updating_for_the_scaling_factors">Delay to start updating for the scaling factors </a><li><a href="#scaling_for_the_step_widths_for_l-ntd_parameters">Scaling for the step widths for L-NTD parameters</a><li><a href="#partial_update_for_coefficients_of_3d_b-spline_functions">Partial update for coefficients of 3d B-spline functions</a><li><a href="#average_update_for_coefficients_of_3d_b-spline_functions">Average update for coefficients of 3d B-spline functions</a></ol><li><a href="#output_text_files">Output text files</a><li><a href="#visualization">Visualization</a><ol><li><a href="#posterior_pdf_and_rms_variation_through_the_mcmc_iteration">Posterior PDF and RMS variation through the MCMC iteration</a><li><a href="#parameter_variation_through_the_mcmc_iteration">Parameter variation through the MCMC iteration</a><li><a href="#correlation_among_the_unknown_parameters">Correlation among the unknown parameters</a><li><a href="#histogram_for_each_unknown_parameter">Histogram for each unknown parameter</a><li><a href="#histograms_and_heatmaps_for_multiple_parameters">Histograms and heatmaps for multiple parameters </a><li><a href="#spatial_variation_of_travel-time_residuals_shallow_gardient">Spatial variation of travel-time residuals &#40;shallow gardient&#41;</a><li><a href="#temporal_variation_of_the_travel-time_residuals">Temporal variation of the travel-time residuals</a></ol><li><a href="#run_mcmc_processing_with_additional_constraints">Run MCMC processing with additional constraints</a></ol></div> <h2 id=make_initial_value_file ><a href="#make_initial_value_file" class=header-anchor >Make initial value file</a></h2> <p>In order to perform the static array positioning considering a sound speed gradient through a MCMC technique &#40;<a href="https://earth-planets-space.springeropen.com/articles/10.1186/s40623-022-01740-0">Tomita &amp; Kido, 2022</a>&#41;, we have to prepare an initial value file &#40;named &quot;initial.inp&quot; by default&#41; which lists initial values of the unknown parameters for MCMC optimization.</p> <p>The dataformat of &quot;initial.inp&quot; is &#40;Columns 1: Initial value, 2: Lower limit, 3: Upper limit, 4: Step width, 5: Parameter name&#41;. The step width is used as perturbation when new parameter candidates are produced in the MCMC sampling. This should be appropriately given to effectively perform a MCMC sampling.</p> <p>The type of unknown parameters to be placed on each line of this file is fixed and cannot be changed.</p> <ul> <li><p>Lines 1-3: Array displacements for EW, NS, UD &#91;m&#93;</p> <li><p>Lines 4-5: Shallow gradients for EW, NS &#91;sec/km&#93;</p> <li><p>Line 6: Gradient depth &#91;km&#93;</p> <li><p>Lines 7-11: Long-term NTD modeled by 4th polynomial function &#40;degree: 0-4&#41;</p> <li><p>Lines 12-13: Scale factor optimizing observational errors</p> <li><p>Lines 14-: Coefficinets for the 3d B-spline bases &#40;Short-term NTD&#41;</p> </ul> <p>This file can be produced by <code>make_initial&#40;fn1,fn2,fn3,fno,error_scale,tscale&#41;</code> function. <code>fn1</code> is the initial seafloor transponder positions: &quot;pxp-ini.xyh&quot;. <code>fn2</code> and <code>fn3</code> are &quot;residual.out&quot; and &quot;solve.out&quot;, respectively; they are obtained by <a href="/SeaGapDocs/tutorialstatic/">the basic static array positioning</a> <code>pos_array_all&#40;&#41;</code>.</p> <p><code>error_scale</code> is used for providing the step width &#40;<code>error_scale&#61;5.0</code> by default&#41;. Then, <code>make_initial&#40;&#41;</code> provides the step widths as &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">1\sigma</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >1</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span> standard deviation / <code>error_scale</code>&#41; for the parameters at Lines 1-3, 7-11, and 14-.</p> <p><code>tscale</code> is used to normalize time when obataining L-NTD parameters as <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mn>4</mn></msubsup><msub><mi>γ</mi><mi>m</mi></msub><msubsup><mi>t</mi><mi>n</mi><mi>m</mi></msubsup><mi mathvariant=normal >/</mi><mo stretchy=false >(</mo><mn>60</mn><mo>∗</mo><mn>60</mn><mo>∗</mo><mrow><mi mathvariant=normal >t</mi><mi mathvariant=normal >s</mi><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi><mi mathvariant=normal >e</mi></mrow><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\sum_{m=0}^{4} \gamma_{m}t^m_n/(60*60*{\rm tscale})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2537em;vertical-align:-0.2997em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2997em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.6644em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mord >/</span><span class=mopen >(</span><span class=mord >60</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >60</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">tscale</span></span></span><span class=mclose >)</span></span></span></span> in <a href="/SeaGapDocs/methodmcmcpvg/">Methodology</a>. Since <code>t</code> indicates the observational time in second, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>60</mn><mo>∗</mo><mn>60</mn></mrow><annotation encoding="application/x-tex">60*60</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >60</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >60</span></span></span></span> converts the time into the unit of hour. In order to promote the acceptance ratio of the MCMC sampling, <code>tscale</code> should be set to the whole observational period &#91;hour&#93;.</p> <pre><code class="julia hljs">SeaGap.make_initial(fn1=<span class=hljs-string >&quot;pxp-ini.xyh&quot;</span>,fn2=<span class=hljs-string >&quot;residual.out&quot;</span>,fn3=<span class=hljs-string >&quot;solve.out&quot;</span>,fno=<span class=hljs-string >&quot;initial.inp&quot;</span>,error_scale=<span class=hljs-number >5.0</span>,tscale=<span class=hljs-number >10.0</span>)</code></pre>
<div class=important >&#36; head -n 20 initial.inp</div>
<pre><code class="plaintext hljs">0.025636280922571503 -20.0 20.0 0.0003285573488282583 EW_disp.
-0.015945415334263136 -20.0 20.0 0.0003275385835573224 NS_disp.
-0.0341679281482854 -20.0 20.0 0.0012002522323013415 UD_disp.
0.0 -20.0 20.0 1.e-6 S-Gradient_EW
0.0 -20.0 20.0 1.e-6 S-Gradient_NS
0.65 0 2.7056096662950706 0.01  Gradient_depth
0.0019017563284706718 -20.0 20.0 1.6611016486294932e-6 L-NTD_1
-0.0007901676224344456 -20.0 20.0 1.5449119464738023e-5 L-NTD_2
0.0015766489100226266 -20.0 20.0 4.222747834588211e-5 L-NTD_3
-0.0012713154100225665 -20.0 20.0 4.290762653134229e-5 L-NTD_4
0.0005980067084534468 -20.0 20.0 1.4451169310092645e-5 L-NTD_5
-4.0 -20.0 20.0 0.005 Scale_1
-3.5 -20.0 20.0 0.005 Scale_2
0.0013391985795993162 -20.0 20.0 5.925901087601794e-5 S-NTD_1
0.0019548158709784824 -20.0 20.0 1.2467626341387438e-5 S-NTD_2
0.0019695006501768662 -20.0 20.0 4.302502267822001e-6 S-NTD_3
0.001779083361610449 -20.0 20.0 2.830791012520501e-6 S-NTD_4
0.002088654982500453 -20.0 20.0 2.596471958417347e-6 S-NTD_5
0.0020800544363949007 -20.0 20.0 2.475559611199917e-6 S-NTD_6
0.002210865507757804 -20.0 20.0 2.4503884543907966e-6 S-NTD_7</code></pre>
<p>If you provide same values for the columns 1-3 at a certain line, the corresponding parameter is handled as a constant parameter. For example, when you provide &quot;0.65&quot; for the columns 1-3 at the 6th line, you can estimate an array displacement with the gradient depth is fixed to 650 m.</p>
<h2 id=run_mcmc_processing ><a href="#run_mcmc_processing" class=header-anchor >Run MCMC processing</a></h2>
<p>Before you run <code>static_array_mcmcgrad&#40;&#41;</code>, you have to set number of threads for the thread parallelization in your terminal as:</p>
<div class=important >&#36; export JULIA&#95;NUM&#95;THREADS&#61;4</div>
<p>or you have to run Julia as:</p>
<div class=important >&#36; julia -t 4</div>
<p>This value is determined depending on your machine ability.</p>
<p>Then, after setting the above thread number and preparing the above input files, you can perform <code>static_array_mcmcgrad&#40;lat,TR_DEPTH,NPB; NSB,nloop,nburn,ndelay,NA,lscale,daave,daind,tscale,fn1,fn2,fn3,fn4,fn5,fno0,fno1,fno2,fno3,fno4,fno5,fno6,fno7&#41;</code> function as following:</p>
<pre><code class="julia hljs">lat=<span class=hljs-number >36.15753</span>; TR_DEPTH=<span class=hljs-number >4.0</span>; NPB=<span class=hljs-number >73</span>
SeaGap.static_array_mcmcgrad(lat,TR_DEPTH,NPB,NSB=<span class=hljs-number >50</span>,aventd=<span class=hljs-literal >true</span>,daave=<span class=hljs-number >2.5e-6</span>,daind=<span class=hljs-number >3.5</span>,lscale=<span class=hljs-number >10.0</span>)</code></pre>
<p>Meanings of the arguments of <code>static_array_mcmcgrad&#40;&#41;</code> are following:</p>
<ul>
<li><p><code>lat</code>: Latitude of the site</p>

<li><p><code>TR_DEPTH</code>: Depth of the sea-surface transducer from the sea-surface &#91;m&#93;</p>

<li><p><code>NPB</code>: Number of the 3d B-spline bases &#40;this should be optimized in the conventional static array positioning <code>pos_array_all_AICBIC&#40;&#41;</code>&#41;</p>

<li><p><code>NSB</code>: Number of the perturbated B-spilne bases for each iteration &#40;<code>NSB&#61;100</code> by default&#41;</p>

<li><p><code>nloop</code>: Total number of the MCMC iterations &#40;1200000 by default&#41;</p>

<li><p><code>nburn</code>: Burn-in period of the MCMC iterations &#40;samples less than <code>nburn</code> is excluded from the final results; 200000 by default&#41;</p>

<li><p><code>ndelay</code>: Number of the MCMC iterations for starting to perturb the scaling parameters &#40;<code>ndelay&#61;1</code> by default&#41;</p>

<li><p><code>NA</code>: Number of the sampling interval &#40;5 by default; if you set &#40;<code>nloop&#61;1200000</code>, <code>nburn&#61;200000</code>, and <code>NA&#61;5</code>&#41;, you can obtain &#40;1200000-200000&#41;/5 samples&#41;</p>

<li><p><code>lscale</code>: Scaling factor for the step width of the long-term NTD parameters &#40;<code>lscale&#61;1.0</code> by default&#41;</p>

<li><p><code>aventd</code>: Provide common perturbation to all S-NTD parameters when <code>aventd&#61;true</code> &#40;<code>aventd&#61;false</code> by default&#41;</p>

<li><p><code>daave</code>: Step width for average NTD when &#40;<code>aventd&#61;true</code>&#41;</p>

<li><p><code>daind</code>: Scaling dactor for step width of individual NTD when &#40;<code>aventd&#61;true</code>&#41;</p>

<li><p><code>tscale</code>: Temporal scaling for time in the polynomial functions &#40;time &#91;sec&#93; is converted into &#91;hour&#93;/<code>tscale</code>, <code>tscale&#61;10</code> by default&#41;</p>

<li><p><code>fn1-5</code>: the input file names &#40;&quot;tr-ant.inp&quot;, &quot;pxp-ini.inp&quot;, &quot;ss&#95;prof.inp&quot;, &quot;obsdata.inp&quot;, and &quot;initial.inp&quot;&#41;</p>

<li><p><code>fno0</code>: the log file &#40;&quot;log.txt&quot; by default&#41;</p>

<li><p><code>fno1-7</code>: the output file names &#40;&quot;sample.out&quot;, &quot;mcmc.out&quot;, &quot;position.out&quot;, &quot;statistics.out&quot;, &quot;acceptance.out&quot;, &quot;residual&#95;grad.out&quot;, and &quot;bspline.out&quot;&#41;</p>

</ul>
<h3 id=delay_to_start_updating_for_the_scaling_factors ><a href="#delay_to_start_updating_for_the_scaling_factors" class=header-anchor >Delay to start updating for the scaling factors </a></h3>
<p>The function has some options to enhance the acceptance ratio. Although the function optimizes the scaling factors for the two observation equations shown in <a href="/SeaGapDocs/methodmcmcpvg/">Methodology</a>, these values sometimes fix before convergence of the other unknown parameters. In such case, <code>ndelay</code> should be set to certain value &#40;such as half of the burn-in period&#41;. By this option, optimization of the scaling factors starts after <code>ndelay</code> iterations.</p>
<h3 id=scaling_for_the_step_widths_for_l-ntd_parameters ><a href="#scaling_for_the_step_widths_for_l-ntd_parameters" class=header-anchor >Scaling for the step widths for L-NTD parameters</a></h3>
<p>Due to the strong covariance among the L-NTD parameters, they tends to decrease the acceptace ratio. In this case, <code>lscale</code> reduces the step widths of the L-NTD parameters. If <code>lscale&#61;10</code>, the step width for each L-NTD parameter is a tenth of the original value. Moreover, <code>tscale</code> is also important to increase the acceptance ratio; <code>tscale</code> used in <code>make_initial&#40;&#41;</code> must be given in <code>tscale</code> here.</p>
<h3 id=partial_update_for_coefficients_of_3d_b-spline_functions ><a href="#partial_update_for_coefficients_of_3d_b-spline_functions" class=header-anchor >Partial update for coefficients of 3d B-spline functions</a></h3>
<p>At each MCMC iteration, not all parameters on the 3d B-spline bases are changed to increase the acceptance ratio. Number of the changed parameters on the 3d B-spline bases is controlled by <code>NSB</code>.</p>
<h3 id=average_update_for_coefficients_of_3d_b-spline_functions ><a href="#average_update_for_coefficients_of_3d_b-spline_functions" class=header-anchor >Average update for coefficients of 3d B-spline functions</a></h3>
<p>If observational data has enough sensitivity to solve a vertical array displacement, it has a trade-off relationship with the average of NTDs. In such a case, the acceptance ratio degrades, and the MCMC sampling fail to express the true posteior PDF on the vertical array displacement.</p>
<p>A simple way to solve this problem is a uniform update on coefficients for 3d B-spline functions <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">c_j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7167em;vertical-align:-0.2861em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> in Equation &#40;5&#41; of <a href="/SeaGapDocs/methodmcmcpvg/">Methodology</a>. This updation is performed when <code>aventd&#61;true</code>.</p>
<p>When <code>aventd&#61;false</code>, a coefficient for the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>th 3d B-spline basis is updated as:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msubsup><mi>c</mi><mi>j</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msubsup><mo>=</mo><msub><mi>c</mi><mi>j</mi></msub><mo>+</mo><mi>u</mi><msub><mi>σ</mi><msub><mi>c</mi><mi>j</mi></msub></msub></mrow><annotation encoding="application/x-tex"> c&#x27;_j=c_j + u\sigma_{c_j} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.185em;vertical-align:-0.3831em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8019em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3831em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.8694em;vertical-align:-0.2861em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.7779em;vertical-align:-0.3473em;"></span><span class="mord mathnormal">u</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3473em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> is a random value defrived from a uniform distribution &#91;-0.5,0.5&#93;, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><msub><mi>c</mi><mi>j</mi></msub></msub></mrow><annotation encoding="application/x-tex">\sigma_{c_j}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7779em;vertical-align:-0.3473em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3473em;"><span></span></span></span></span></span></span></span></span></span> is a step width for this parameter given in &quot;initial.inp&quot;. By contrast, when <code>aventd&#61;true</code>, a coefficient for the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>th 3d B-spline basis is updated as:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msubsup><mi>c</mi><mi>j</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msubsup><mo>=</mo><msub><mi>c</mi><mi>j</mi></msub><mo>+</mo><msub><mi>u</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >m</mi></mrow></msub><msub><mi>σ</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >m</mi></mrow></msub><mo>+</mo><mi>u</mi><msub><mi>σ</mi><msub><mi>c</mi><mi>j</mi></msub></msub><mi mathvariant=normal >/</mi><msub><mi mathvariant=normal >Δ</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex"> c&#x27;_j=c_j + u_{\rm com}\sigma_{\rm com} + u\sigma_{c_j}/\Delta_{c} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.185em;vertical-align:-0.3831em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8019em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3831em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.8694em;vertical-align:-0.2861em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.7333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">com</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">com</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.0973em;vertical-align:-0.3473em;"></span><span class="mord mathnormal">u</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3473em;"><span></span></span></span></span></span></span><span class=mord >/</span><span class=mord ><span class=mord >Δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">u_{\rm com}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5806em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">com</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> a random value defrived from a uniform distribution &#91;-0.5,0.5&#93;, but it is a common value among the coefficients at each updation. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{\rm com}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5806em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">com</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is a step width for whole 3d B-spline functions. Thus, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >m</mi></mrow></msub><msub><mi>σ</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">u_{\rm com}\sigma_{\rm com}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5806em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">com</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">com</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> give a perturbation to the average level of the 3d B-spline functions. While, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><msub><mi>σ</mi><msub><mi>c</mi><mi>j</mi></msub></msub></mrow><annotation encoding="application/x-tex">u\sigma_{c_j}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7779em;vertical-align:-0.3473em;"></span><span class="mord mathnormal">u</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3473em;"><span></span></span></span></span></span></span></span></span></span> give a pertubation to the individual coefficient for the  3d B-spline basis, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=normal >Δ</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">\Delta_{c}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord >Δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is a scaling factor to encourage acceptance by providing <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=normal >Δ</mi><mi>c</mi></msub><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\Delta_{c}&gt;1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord >Δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >1</span></span></span></span>.</p>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{\rm com}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5806em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">com</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=normal >Δ</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">\Delta_{c}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord >Δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> can be given as <code>daave</code> and <code>daind</code>, respectively. </p>
<h2 id=output_text_files ><a href="#output_text_files" class=header-anchor >Output text files</a></h2>
<div class=importantv >fno0: the log file, which shows the analytical conditions, and so on</div>
<div class=important >&#36; head log.txt</div>
<pre><code class="plaintext hljs">2023-01-17T19:00:41.919
static_array_mcmcgrad.jl at /Users/test_PC/SeaGap_test/mcmc
Number of threads: 4
Number_of_B-spline_knots: 77
Default_latitude: 36.15753
TR_DEPTH: 4.0
Number_of_MCMC_loop: 1200000
Burn_in_period: 200000
Sampling_interval: 5
Scale: true</code></pre>
<div class=importantv >fno1: The sampled unknown parameters &#40;&quot;sample.out&quot; by default&#41;</div>
<p>In this file, the unknown parameter names written in &quot;initial.inp&quot; is written at the first line. Then, the sampled parameters for each MCMC iteration at each line.</p>
<div class=important >&#36; head sample.out | awk &#39;&#123;print &#36;1,&#36;2,&#36;3,&#36;4,&#36;5,&#36;6&#125;&#39;</div>
<pre><code class="plaintext hljs">EW_disp. NS_disp. UD_disp. S-Gradient_EW S-Gradient_NS Gradient_depth
0.0792280816606764 -0.07808502829846697 -0.038635864431547984 -8.68250555312698e-5 0.0001083565550747744 1.2313132109702847
0.0792280816606764 -0.07808502829846697 -0.038635864431547984 -8.68250555312698e-5 0.0001083565550747744 1.2313132109702847
0.0792280816606764 -0.07808502829846697 -0.038635864431547984 -8.718446946801919e-5 0.00010799325700068288 1.2313132109702847
0.0792280816606764 -0.07808502829846697 -0.038635864431547984 -8.649523108069255e-5 0.00010798884128099522 1.2313132109702847
0.0792280816606764 -0.07808502829846697 -0.038635864431547984 -8.649523108069255e-5 0.00010798884128099522 1.2313132109702847
0.07951942860412713 -0.07842957364617842 -0.03781991489286092 -8.733991904332083e-5 0.00010881386462605156 1.2344368074146146
0.0797973876496036 -0.07865097632952621 -0.038638614141646405 -8.643812294091133e-5 0.00010794655607095396 1.230610894350092
0.0797973876496036 -0.07865097632952621 -0.038638614141646405 -8.738808866230476e-5 0.00010699597479892664 1.230610894350092
0.0797973876496036 -0.07865097632952621 -0.038638614141646405 -8.755999059925743e-5 0.00010683959008568226 1.230610894350092</code></pre>
<div class=importantv >fno2: The PDFs and RMS &#40;&quot;mcmc.out&quot; by default&#41;</div>
<p>In this file, the PDF and RMS values for each MCMC iteration are recorded.</p>
<ul>
<li><p>1: Iteration number</p>

<li><p>2: Process number &#40;0 and 1 corresponds to optimization for observation equations 1 and 2, respectively&#41;</p>

<li><p>3: Acceptance &#40;0 and 1 are reject and accept the MCMC perturbation, respectively&#41;</p>

<li><p>4: The posterior PDF for the observation equation 1</p>

<li><p>5: The posterior PDF for the observation equation 2</p>

<li><p>6: The total posterior PDF</p>

<li><p>7: RMS for the observation equation 1</p>

<li><p>8: RMS for the observation equation 2</p>

</ul>
<div class=important >&#36; head mcmc.out</div>
<pre><code class="plaintext hljs">5 1 1 30640.5316249358 26757.182836699594 57397.71446163539 3.419040965749844e-5 0.00012051927477698287
10 0 0 30644.022168433235 26813.7289314623 57457.75109989554 3.429663404938296e-5 0.0001175853809320721
15 1 1 30644.02943515391 26821.252387755638 57465.28182290954 3.429600320700134e-5 0.00011634444275541483
20 0 1 30687.95350102651 26823.489752791196 57511.443253817706 3.449121949976427e-5 0.00011579450769642835
25 1 0 30687.992457113745 26871.354381771493 57559.346838885234 3.44879605037534e-5 0.00011191537288709573
30 0 1 30704.209918043824 26886.500131302717 57590.71004934654 3.466740851167605e-5 0.00011215778277425875
35 1 1 30733.804150874275 26917.628966105163 57651.43311697944 3.430833898450772e-5 0.00011717803812660892
40 0 0 30733.799521863253 26943.733104792474 57677.532626655724 3.430871686462821e-5 0.00011672459488211255
45 1 0 30751.288984391485 26975.74207282055 57727.031057212036 3.435878909575146e-5 0.00011265293645483022
50 0 0 30772.365768478183 26975.302681107092 57747.668449585275 3.4477732396622186e-5 0.00011275388395079637</code></pre>
<div class=importantv >fno3: The position file &#40;&quot;position.out&quot; by default&#41;</div>
<p>This is same format with the &quot;position.out&quot; of <code>pos_array_all&#40;&#41;</code>. &#40;1: the cumlative seconds of the observational time, 2-4: Mean array displacements for EW, NS, UD componets, 5-7: Standard deviations of 2-4&#41;</p>
<div class=important >&#36; cat position.out</div>
<pre><code class="plaintext hljs">5.006911464354839e8 0.078367613458201 -0.08514945576712399 -0.0340102206482122 0.005144727208048865 0.0062974579205844075 0.005704865959222425</code></pre>
<div class=importantv >fno4: Statistical values for each unknown parameter &#40;&quot;statistics.out&quot; by default&#41;</div>
<div class=important >&#36; head statistics.out</div>
<pre><code class="plaintext hljs">#Parameter mean std median min max
 &quot;EW_disp.&quot;         0.078367613458201       0.005144727208048865     0.07784887468370676     0.06576224682341979      0.09457305348507103
 &quot;NS_disp.&quot;        -0.08514945576712399     0.0062974579205844075   -0.08511206694720905    -0.10587183701850005     -0.06705651655040301
 &quot;UD_disp.&quot;        -0.0340102206482122      0.005704865959222425    -0.03399846412638977    -0.05436245652909059     -0.011735357475848841
 &quot;S-Gradient_EW&quot;   -8.62246678447068e-5     3.0006948844345516e-6   -8.618574116032473e-5   -9.955275906691991e-5    -7.521556344838198e-5
 &quot;S-Gradient_NS&quot;    0.00011325398201524354  3.86941849574838e-6      0.0001134357635898253   9.664595891720896e-5     0.0001267846621482411
 &quot;Gradient_depth&quot;   1.2761646163708869      0.11917931187797215      1.2623998589766008      0.966240303135601        1.7100642291626729
 &quot;L-NTD_1&quot;          0.0018826733230646996   1.631740677798977e-5     0.0018779421385805451   0.0018583776140325026    0.0019242964772991215
 &quot;L-NTD_2&quot;          1.5164726762837501e-5   0.0001486215962420044    6.485270965536119e-5   -0.0003530570926899982    0.0002029738274772864
 &quot;L-NTD_3&quot;         -0.00027510582677679063  0.0004028444295857216   -0.0004212020126622335  -0.0007469938247558138    0.0006869512725884606</code></pre>
<div class=importantv >fno5: Acceptance ratio &#40;&quot;acceptance.out&quot; by default&#41;</div>
<p>The first and second lines show the acceptance ratios for the observation equations 1 and 2, respectively.</p>
<div class=important >&#36; cat acceptance.out</div>
<pre><code class="plaintext hljs">Acceptance_ratio_MCMC-1: 0.2813833333333333
Acceptance_ratio_MCMC-2: 0.28363333333333335</code></pre>
<p>Note that it is plausible to adjust the pertubation widths as the acceptance ratio is ~23 &#37; when sampling multiple parameters &#40;<a href="https://global.oup.com/academic/product/bayesian-statistics-5-9780198523567?cc&#61;jp&amp;lang&#61;en&amp;#">Gelman et al., 1996</a>&#41;</p>
<div class=importantv >fno6: Data residuals including the NTD and gradient effects &#40;&quot;residual&#95;grad.out&quot; by default&#41;</div>
<p>The effects of the modeled NTD and gradients on the data residuals are shown.</p>
<ul>
<li><p>1: The cumulative seconds of the observational time</p>

<li><p>2: Seafloor transponder number</p>

<li><p>3: EW sea-surface platform positions</p>

<li><p>4: NS sea-surface platform positions</p>

<li><p>5: UD sea-surface platform positions</p>

<li><p>6: Projected travel-time residuals &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msubsup><mi>T</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow><mrow><mi mathvariant=normal >o</mi><mi mathvariant=normal >b</mi><mi mathvariant=normal >s</mi></mrow></msubsup><mo>−</mo><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msup><mi>T</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi mathvariant=bold >p</mi><mi>k</mi></msub><mo>+</mo><mi>δ</mi><mi mathvariant=bold >p</mi><mo separator=true >,</mo><mi mathvariant=bold >u</mi><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo separator=true >,</mo><msub><mi mathvariant=bold >b</mi><mn>0</mn></msub><mo fence=true >)</mo></mrow><mo separator=true >,</mo><msub><mi>v</mi><mn>0</mn></msub><mo fence=true >)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{1}{M\left(\xi_{n,k}\right)} T_{n,k}^{\mathrm{obs}}-\frac{1}{M\left(\xi_{n,k}\right)} {T}^{\mathrm{cal}}\left(\mathbf{p}_k+\delta \mathbf{p}, \mathbf{u}\left(t_{n},{\bf b}_0\right), v_0\right)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.3972em;vertical-align:-0.5481em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8451em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class=mtight >(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.046em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2901em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class=mtight >)</span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">obs</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.4192em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.3972em;vertical-align:-0.5481em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8451em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class=mtight >(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.046em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2901em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class=mtight >)</span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord mathbf">p</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathbf">u</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">b</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>&#41;</p>

<li><p>7: The modeled NTD by 3d B-spilne function &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></msubsup><msub><mi>c</mi><mi>j</mi></msub><msub><mi mathvariant=normal >Φ</mi><mi>j</mi></msub><mo stretchy=false >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\sum_{j=1}^{J}c_j\Phi_j(t_n)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.417em;vertical-align:-0.4358em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.4358em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord >Φ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span>&#41;</p>

<li><p>8: Effects of the deep gradients &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>D</mi><mn>2</mn></mfrac><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub><msub><mi mathvariant=bold >h</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\frac{D}{2}\mathbf{g}_{\mathrm{s}}\mathbf{h}_{n,k}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2173em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8723em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf">h</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>&#41;</p>

<li><p>9: The modeled travel-time in the observation equation 1 &#40;7&#43;8&#41;</p>

<li><p>10: The long-term NTD modeled by 4th polynomial funcions &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mn>4</mn></msubsup><msub><mi>γ</mi><mi>m</mi></msub><msubsup><mi>t</mi><mi>n</mi><mi>m</mi></msubsup></mrow><annotation encoding="application/x-tex">\sum_{m=0}^{4} \gamma_{m}t^m_n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2537em;vertical-align:-0.2997em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2997em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.6644em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>&#41;</p>

<li><p>11: Effects of the shallow gradients &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub><msup><mi mathvariant=bold >u</mi><mrow><mi mathvariant=normal >h</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >r</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo fence=true >)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{g}_{\mathrm{s}} \mathbf{u}^{\mathrm{hor}}\left(t_{n}\right)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0991em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf">u</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">hor</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>&#41;</p>

<li><p>12: The modeled travel-time in the observation equation 2 &#40;10&#43;11&#41;</p>

<li><p>13: The final travel-time residuals &#40;6-9&#41;</p>

</ul>
<div class=important >&#36; head residual&#95;grad.out</div>
<pre><code class="plaintext hljs">5.00664410095011e8    4.0     96.89902643051431        88.03270369967535      15.953261659441749  0.0017979333422704167  0.0018584604480744815  -4.5251727191123945e-5   0.0018132087208833575  0.0018826746247814269   1.6149678731097327e-6   0.0018842895926545367  -1.527537861294089e-5
 5.00664440093926e8    4.0    113.06319366902844        96.4390767559066       15.728498650814862  0.0018355095168310143  0.0018711757256623697  -4.5152091136073423e-5   0.0018260236345262963  0.00188268703141493     1.1732731449064043e-6   0.0018838603045598363   9.48588230471805e-6
 5.00664920015051e8    1.0    317.258830646345         266.20104706095884      16.12337475425815   0.0019492644996791438  0.0019535287641539263   5.280610901181443e-6    0.001958809375055108   0.00188283456345753     2.7927913029996435e-6   0.0018856273547605297  -9.54487537596393e-6
 5.0066492022755253e8  3.0    317.4171843638199        266.24101689269014      16.27763781567538   0.001896763873769342   0.00195352481786977    -6.6592942217753765e-6   0.0019468655236479946  0.0018828346079298765   2.783664048912453e-6    0.001885618271978789   -5.0101649878652764e-5
 5.0066492010527e8     4.0    317.3272458725733        266.2184268441425       16.190149350893314  0.0019459624690290592  0.0019535270920768163  -4.5522462116032325e-5   0.0019080046299607839  0.001882834582340793    2.788860552494706e-6    0.001885623442893288    3.7957839068275224e-5
 5.0066498000643504e8  1.0    359.35661904162504       277.1735513446349       15.411855263006803  0.001964701328794626   0.001951368659445891    5.834976455921046e-6    0.0019572036359018124  0.0018828464000669632   4.056032844255083e-7    0.0018832520033513886   7.497692892814044e-6
 5.00664980241396e8    3.0    359.62420167355594       277.19483358357854      15.511658046421838  0.001899893275194323   0.001951356235912045   -6.095318608697708e-6    0.0019452609173033473  0.001882846443597678    3.8494135917281093e-7   0.0018832313849568509  -4.5367642109024196e-5
 5.00664980102315e8    4.0    359.467298440242         277.18216826356564      15.453882681451681  0.0019338113118865475  0.0019513635933835552  -4.497496940807374e-5    0.0019063886239754815  0.0018828464178330987   3.970358904241129e-7    0.0018832434537235229   2.7422687911066072e-5
 5.00665039994504e8    1.0    418.9642018513322        300.25882611368763      15.696507359928955  0.0019360458657012283  0.0019472760245312756   6.419280227790985e-6    0.0019536953047590666  0.0018828568007591216  -2.119541450856093e-6    0.0018807372593082656  -1.7649439057838284e-5
 5.006650402641685e8   3.0    419.2394061616972        300.4615189327145       15.708606565510767  0.0019039860680888346  0.0019472536413713678  -5.503913368437491e-6    0.0019417497280029303  0.001882856844287782   -2.120315082226064e-6    0.001880736529205556   -3.7763659914095765e-5</code></pre>
<div class=importantv >fno7: &#40;&quot;bspline.out&quot; by default&#41;</div>
<p>Format of this file is same  with that of <code>pos_array_all&#40;&#41;</code>.</p>
<div class=important >&#36; head bspline.out</div>
<pre><code class="plaintext hljs">1 1 5.006636573280344e8 0.001298067358242476
2 2 5.00664407e8 0.0019696571745976103
3 3 5.006651566719656e8 0.0019658305782191935
4 4 5.006659063439312e8 0.0017753643399709875
5 5 5.006666560158968e8 0.0020988732080715793
6 6 5.006674056878624e8 0.0020949154531169916
7 7 5.00668155359828e8 0.002228873405588681
8 8 5.006689050317936e8 0.0018684765371399623
9 9 5.006696547037592e8 0.0017853297206791739
10 10 5.006704043757248e8 0.0016702469705376871</code></pre>
<h2 id=visualization ><a href="#visualization" class=header-anchor >Visualization</a></h2>
<p>SeaGap prepares various functions to visualize results of the MCMC processing.</p>
<h3 id=posterior_pdf_and_rms_variation_through_the_mcmc_iteration ><a href="#posterior_pdf_and_rms_variation_through_the_mcmc_iteration" class=header-anchor >Posterior PDF and RMS variation through the MCMC iteration</a></h3>
<p>When you&#39;d like to check how the posterior PDF and the travel-time RMS change through the MCMC iteration, you can draw by <code>plot_mcmcres&#40;;fn,fno,show,nshuffle&#41;</code>. </p>
<ul>
<li><p>fn: the input file name &#40;<code>fn&#61;&quot;mcmc.out&quot;</code> by default&#41;</p>

<li><p>fno: Output figure name &#40;<code>fno&#61;&quot;mcmc_res.pdf&quot;</code> by default&#41;</p>

<li><p>show: if <code>show&#61;true</code>, a figure is shown on REPL and is not saved as a file &#40;<code>show&#61;false</code> by default&#41;</p>

<li><p>nshuffle: number of plots &#40;if all samples are plotted, the figure is crowded; thus, <code>nshuffle</code> of samples are randomly picked; if <code>nshuffle&#61;0</code>, all samples are plotted; <code>nshuffle&#61;50000</code> by default&#41;</p>

</ul>
<p>You can adjust the fontsizes or figuresize by the other arguments.</p>
<pre><code class="julia hljs">SeaGap.plot_mcmcres(fno=<span class=hljs-string >&quot;mcmc_res.pdf&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/mcmc_res.png" width=350  height=350 >
    <div style="clear: both"></div>
  </div>
</div>

<h3 id=parameter_variation_through_the_mcmc_iteration ><a href="#parameter_variation_through_the_mcmc_iteration" class=header-anchor >Parameter variation through the MCMC iteration</a></h3>
<p>When you&#39;d like to check how the unknown parameters change through the MCMC iteration, you can draw by <code>plot_mcmcparam&#40;NA;fn,fno,show,nshuffle&#41;</code>.</p>
<ul>
<li><p>NA: Sampling interval of the MCMC prcessing &#40;<code>NA&#61;5</code> by default&#41;, which must be same with <code>NA</code> in <code>pos_array_mcmcpvg</code></p>

<li><p>fn: the input file name &#40;<code>fn&#61;&quot;sample.out&quot;</code> by default&#41;</p>

<li><p>fno: Output figure name &#40;<code>fno&#61;&quot;mcmc_param.pdf&quot;</code> by default&#41;</p>

<li><p>show: if <code>show&#61;true</code>, a figure is shown on REPL and is not saved as a file &#40;<code>show&#61;false</code> by default&#41;</p>

<li><p>nshuffle: number of plots for each parameter &#40;if all samples are plotted, the figure is crowded; thus, <code>nshuffle</code> of samples are randomly picked; if <code>nshuffle&#61;0</code>, all samples are plotted; <code>nshuffle&#61;10000</code> by default&#41;</p>

</ul>
<p>You can adjust the fontsizes or figuresize by the other arguments.</p>
<pre><code class="julia hljs">SeaGap.plot_mcmcparam(<span class=hljs-number >5</span>,fno=<span class=hljs-string >&quot;mcmc_param.pdf&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/mcmc_param.png" width=600  height=600 >
    <div style="clear: both"></div>
  </div>
</div>

<p>In this function, major six unknown parameters are shown. If you&#39;d like to draw a figure for the other paramters, you can use <code>plot_mcmcparam_each&#40;param,NA;fn,fno,show,nshuffle&#41;</code>. <code>param</code> is the parameter name written in &quot;initial.inp&quot;.</p>
<pre><code class="julia hljs">SeaGap.plot_mcmcparam_each(<span class=hljs-string >&quot;S-NTD_10&quot;</span>,<span class=hljs-number >5</span>,fno=<span class=hljs-string >&quot;mcmc_param_S-NTD_10.png&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/mcmc_param_S-NTD_10.png" width=150  height=150 >
    <div style="clear: both"></div>
  </div>
</div>

<h3 id=correlation_among_the_unknown_parameters ><a href="#correlation_among_the_unknown_parameters" class=header-anchor >Correlation among the unknown parameters</a></h3>
<p>When you&#39;d like to simply check the trade-off relationship among the unknown parameters, you can draw a correlation map by <code>plot_cormap&#40;fn,fno0,fno,show,txt,all,as,pfs,plot_size&#41;</code>.</p>
<ul>
<li><p>fn: the input file name &#40;<code>fn&#61;&quot;sample.out&quot;</code> by default&#41;</p>

<li><p>fno0: Output text data file name &#40;if <code>txt&#61;true</code>, correlation coefficients are save in this file; <code>fno0&#61;&quot;correlation.out&quot;</code>&#41;</p>

<li><p>fno: Output figure name &#40;<code>fno&#61;&quot;cormap.pdf&quot;</code> by default&#41;</p>

<li><p>show: if <code>show&#61;true</code>, a figure is shown on REPL and is not saved as a file &#40;<code>show&#61;false</code> by default&#41;</p>

<li><p>txt: Text data file output &#40;<code>txt&#61;false</code> by default&#41;</p>

<li><p>all: if <code>all&#61;true</code>, correlation coefficients are calculated for all parameters; if <code>all&#61;false</code>, correlation coefficients are calculated for major paramters &#40;array displacements, shallow gradients, gradient depth&#41;</p>

<li><p>as: Fontsize of parameter names &#40;<code>as&#61;10</code> by default&#41;</p>

<li><p>pfs: Fontsize of annotated correlation values &#40;<code>pfs&#61;8</code> by default&#41;</p>

<li><p>plot&#95;size: Figure size &#40;<code>plot_size&#61;&#40;&#41;</code> by default&#41;</p>

</ul>
<pre><code class="julia hljs">SeaGap.plot_cormap(fno=<span class=hljs-string >&quot;cormap.png&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/cormap.png" width=450  height=450 >
    <div style="clear: both"></div>
  </div>
</div>

<p>If you set as following:</p>
<pre><code class="julia hljs">SeaGap.plot_cormap(all=<span class=hljs-literal >true</span>,fno=<span class=hljs-string >&quot;cormap_all.png&quot;</span>,plot_size=(<span class=hljs-number >1400</span>,<span class=hljs-number >1400</span>),txt=<span class=hljs-literal >true</span>)</code></pre>
<p>you obtain the below figure and the output text data</p>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/cormap_all.png" width=450  height=450 >
    <div style="clear: both"></div>
  </div>
</div>

<div class=important >&#36; head -n 6 correlation.out | awk \&#39;&#123;print &#36;1,&#36;2,&#36;3,&#36;4,&#36;5,&#36;6&#125;\&#39;</div>
<pre><code class="plaintext hljs">Name: EW_disp. NS_disp. UD_disp. S-Gradient_EW S-Gradient_NS
&quot;EW_disp.&quot; 1.0 -0.634376617642439 -0.09873898084769465 -0.4559821875070524 -0.08852812940100827
&quot;NS_disp.&quot; -0.634376617642439 1.0 0.07959031864890413 -0.055760129578559775 -0.36041442138448465
&quot;UD_disp.&quot; -0.09873898084769465 0.07959031864890413 1.0 -0.026356064178314775 0.1619929930250248
&quot;S-Gradient_EW&quot; -0.4559821875070524 -0.055760129578559775 -0.026356064178314775 1.0 -0.04550428034648942
&quot;S-Gradient_NS&quot; -0.08852812940100827 -0.36041442138448465 0.1619929930250248 -0.04550428034648942 1.0</code></pre>
<p>You can see the strong correlation between the horizontal array displacements and the gradient depth, and between the vertical array displacement and NTDs.</p>
<h3 id=histogram_for_each_unknown_parameter ><a href="#histogram_for_each_unknown_parameter" class=header-anchor >Histogram for each unknown parameter</a></h3>
<p>From the MCMC samples &#40;&quot;sample.out&quot;&#41;, you can draw a histogram for each unknown parameter by <code>plot_histogram&#40;NPB,fn0,fn,fno,all,drawnls,nbins&#41;</code>.</p>
<ul>
<li><p>NPB: Number of 3d B-spline bases</p>

<li><p>fn0: Inversion results by <code>pos_array_all&#40;&#41;</code> &#40;&quot;solve.out&quot; by default&#41;, which is used when you&#39;d like to plot the <code>pos_array_all&#40;&#41;</code> results on the histogram</p>

<li><p>fn: Input file &#40;&quot;sample.out&quot; by default&#41;</p>

<li><p>fno: Output figure name &#40;note that this file must be a PDF file: &quot;histogram.pdf&quot; by default&#41;</p>

<li><p>all: if <code>all&#61;true</code>, histograms for all parameters are drawn; if <code>all&#61;false</code>, histograms for major six parameters &#40;array displacements, shallow gradients, gradient depth&#41; &#40;<code>all&#61;false</code> by default&#41;</p>

<li><p>drawnls: if <code>drawnls&#61;true</code>, a normal distribution estimated by <code>pos_array_all&#40;&#41;</code> is drawn in a histogram &#40;<code>drawnls&#61;false</code> by default&#41;; the normal distributions are shown for the array displacements and 3d B-spline NTDs</p>

<li><p>nbins: Number of histogram&#39;s intervals &#40;<code>nbins&#61;50</code> by default&#41;</p>

</ul>
<pre><code class="julia hljs">SeaGap.plot_histogram(<span class=hljs-number >77</span>,all=<span class=hljs-literal >true</span>,fno=<span class=hljs-string >&quot;histogram_all.pdf&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/histogram_all.jpg" width=400  height=400 >
    <div style="clear: both"></div>
  </div>
</div>

<pre><code class="julia hljs">SeaGap.plot_histogram(<span class=hljs-number >77</span>,all=<span class=hljs-literal >true</span>,fno=<span class=hljs-string >&quot;histogram_allv.pdf&quot;</span>,drawnls=<span class=hljs-literal >true</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/histogram_allv.jpg" width=400  height=400 >
    <div style="clear: both"></div>
  </div>
</div>

<h3 id=histograms_and_heatmaps_for_multiple_parameters ><a href="#histograms_and_heatmaps_for_multiple_parameters" class=header-anchor >Histograms and heatmaps for multiple parameters </a></h3>
<p>Using <code>plot_histogram2d&#40;fn,fno,show,nshufflei,nbins&#41;</code>, you can draw a figure showing histograms, heatmaps, and scatter maps for major six parameters &#40;array displacements, shallow gradients, gradient depth&#41;.</p>
<ul>
<li><p>fn: Input file &#40;&quot;sample.out&quot; by default&#41;</p>

<li><p>fno: Output figure name</p>

<li><p>show: if <code>show&#61;true</code>, a figure is shown on REPL and is not saved as a file &#40;<code>show&#61;false</code> by default&#41;</p>

<li><p>nshuffle: number of plots for each parameter &#40;if all samples are plotted, the figure is crowded; thus, <code>nshuffle</code> of samples are randomly picked; if <code>nshuffle&#61;0</code>, all samples are plotted; <code>nshuffle&#61;10000</code> by default&#41;</p>

<li><p>nbins: Number of histogram&#39;s intervals &#40;<code>nbins&#61;50</code> by default&#41;</p>

</ul>
<p>You can adjust fontsizes, margins of panels, and figure size by the other arguments. </p>
<pre><code class="julia hljs">SeaGap.plot_histogram2d(fno=<span class=hljs-string >&quot;histogram2d.pdf&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/histogram2d.jpg" width=500  height=500 >
    <div style="clear: both"></div>
  </div>
</div>

<p>Diagonal panels show histograms for individual parameter. Upper triangle panels show scatter maps for corresponding two parameters. Lower triangle panels show heat maps for corresponding two parameters.</p>
<p>If you&#39;d like to draw a heatmap for certain two parameters, you can make it by <code>plot_histogram2d_each&#40;param1,param2,fn,fno,show,nbins&#41;</code>. <code>param1</code> and <code>param2</code> are the parameter names written in &quot;initial.inp&quot;.</p>
<pre><code class="julia hljs">SeaGap.plot_histogram2d_each(<span class=hljs-string >&quot;UD_disp.&quot;</span>,<span class=hljs-string >&quot;S-NTD_10&quot;</span>,fno=<span class=hljs-string >&quot;histogram2d_UD_SNTD-10.png&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/histogram2d_UD_SNTD-10.png" width=350  height=350 >
    <div style="clear: both"></div>
  </div>
</div>

<h3 id=spatial_variation_of_travel-time_residuals_shallow_gardient ><a href="#spatial_variation_of_travel-time_residuals_shallow_gardient" class=header-anchor >Spatial variation of travel-time residuals &#40;shallow gardient&#41;</a></h3>
<p>Considering from the observation equation &#40;2&#41;, the projected travel-time residuals subtracting the deep gradient and long-term NTD &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msubsup><mi>T</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow><mrow><mi mathvariant=normal >o</mi><mi mathvariant=normal >b</mi><mi mathvariant=normal >s</mi></mrow></msubsup><mo>−</mo><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msup><mi>T</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi mathvariant=bold >p</mi><mi>k</mi></msub><mo>+</mo><mi>δ</mi><mi mathvariant=bold >p</mi><mo separator=true >,</mo><mi mathvariant=bold >u</mi><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo separator=true >,</mo><msub><mi mathvariant=bold >b</mi><mn>0</mn></msub><mo fence=true >)</mo></mrow><mo separator=true >,</mo><msub><mi>v</mi><mn>0</mn></msub><mo fence=true >)</mo></mrow><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mn>4</mn></msubsup><msub><mi>γ</mi><mi>m</mi></msub><msubsup><mi>t</mi><mi>n</mi><mi>m</mi></msubsup><mo>−</mo><mfrac><mi>D</mi><mn>2</mn></mfrac><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub><msub><mi mathvariant=bold >h</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\frac{1}{M\left(\xi_{n,k}\right)} T_{n,k}^{\mathrm{obs}}-\frac{1}{M\left(\xi_{n,k}\right)} {T}^{\mathrm{cal}}\left(\mathbf{p}_k+\delta \mathbf{p}, \mathbf{u}\left(t_{n},{\bf b}_0\right), v_0\right)- \sum_{m=0}^{4} \gamma_{m}t^m_n-\frac{D}{2}\mathbf{g}_{\mathrm{s}}\mathbf{h}_{n,k}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.3972em;vertical-align:-0.5481em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8451em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class=mtight >(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.046em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2901em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class=mtight >)</span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">obs</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.4192em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.3972em;vertical-align:-0.5481em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8451em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class=mtight >(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.046em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2901em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class=mtight >)</span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord mathbf">p</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathbf">u</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">b</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.2537em;vertical-align:-0.2997em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2997em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.6644em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.2173em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8723em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf">h</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>&#41; indicate the spatial variation due to the shallow gradients. <code>plot_gradmap&#40;xrange,yrange;autoscale,fn1,fn2,fno,show&#41;</code> draws a sea-surface platform track with color of the spatial variation due to the shallow gradients.</p>
<ul>
<li><p>xrange: Range of EW component in meters when <code>autoscale&#61;false</code></p>

<li><p>yrange: Range of NS component in meters when <code>autoscale&#61;false</code></p>

<li><p>autoscale: If <code>autoscale&#61;true</code>, the plot range is automatically defined</p>

<li><p>fn1: File name of the seafloor transponder positions &#40;&quot;pxp-ini.xyh&quot;&#41;  </p>

<li><p>fn2: Travel-time residual file name &#40;&quot;residual&#95;grad.out&quot;&#41;</p>

<li><p>fno: Output figure name &#40;&quot;gradmap.pdf&quot; by default&#41;</p>

<li><p>show: if <code>show&#61;true</code>, a figure is shown on REPL and is not saved as a file &#40;<code>show&#61;false</code> by default&#41;</p>

</ul>
<pre><code class="julia hljs">SeaGap.plot_gradmap((-<span class=hljs-number >2500</span>,<span class=hljs-number >2500</span>),(-<span class=hljs-number >2500</span>,<span class=hljs-number >2500</span>),autoscale=<span class=hljs-literal >false</span>,fno=<span class=hljs-string >&quot;gradmap.png&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/gradmap.png" width=400  height=400 >
    <div style="clear: both"></div>
  </div>
</div>

<h3 id=temporal_variation_of_the_travel-time_residuals ><a href="#temporal_variation_of_the_travel-time_residuals" class=header-anchor >Temporal variation of the travel-time residuals</a></h3>
<p>Time-series of the travel-time residuals are plotted by <code>plot_ntdgrad&#40;ntdrange,resrange;autoscale,fn,fno,show&#41;</code>.</p>
<ul>
<li><p>ntdrange: Range of the upper two panels in msec when <code>autoscale&#61;false</code></p>

<li><p>resrange: Range of the lowest panels in msec when <code>autoscale&#61;false</code></p>

<li><p>autoscale: If <code>autoscale&#61;true</code>, the plot range is automatically defined</p>

<li><p>fn: Travel-time residual file name &#40;&quot;residual&#95;grad.out&quot;&#41;</p>

<li><p>fno: Output figure name &#40;&quot;ntdgrad.pdf&quot; by default&#41;</p>

<li><p>show: if <code>show&#61;true</code>, a figure is shown on REPL and is not saved as a file &#40;<code>show&#61;false</code> by default&#41;</p>

</ul>
<pre><code class="julia hljs">SeaGap.plot_ntdgrad()</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/ntdgrad.png" width=600  height=600 >
    <div style="clear: both"></div>
  </div>
</div>

<p>The upper panel shows the projected travel-time residuals &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msubsup><mi>T</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow><mrow><mi mathvariant=normal >o</mi><mi mathvariant=normal >b</mi><mi mathvariant=normal >s</mi></mrow></msubsup><mo>−</mo><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msup><mi>T</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi mathvariant=bold >p</mi><mi>k</mi></msub><mo>+</mo><mi>δ</mi><mi mathvariant=bold >p</mi><mo separator=true >,</mo><mi mathvariant=bold >u</mi><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo separator=true >,</mo><msub><mi mathvariant=bold >b</mi><mn>0</mn></msub><mo fence=true >)</mo></mrow><mo separator=true >,</mo><msub><mi>v</mi><mn>0</mn></msub><mo fence=true >)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{1}{M\left(\xi_{n,k}\right)} T_{n,k}^{\mathrm{obs}}-\frac{1}{M\left(\xi_{n,k}\right)} {T}^{\mathrm{cal}}\left(\mathbf{p}_k+\delta \mathbf{p}, \mathbf{u}\left(t_{n},{\bf b}_0\right), v_0\right)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.3972em;vertical-align:-0.5481em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8451em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class=mtight >(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.046em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2901em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class=mtight >)</span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">obs</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.4192em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.3972em;vertical-align:-0.5481em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8451em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class=mtight >(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.046em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2901em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class=mtight >)</span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord mathbf">p</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathbf">u</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">b</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>&#41; by cross symbols. Moreover, black dots show combination of the 3d B-splined NTD and the deep gradient contribution &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></msubsup><msub><mi>c</mi><mi>j</mi></msub><msub><mi mathvariant=normal >Φ</mi><mi>j</mi></msub><mo stretchy=false >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy=false >)</mo><mo>+</mo><mfrac><mi>D</mi><mn>2</mn></mfrac><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub><msub><mi mathvariant=bold >h</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sum_{j=1}^{J}c_j\Phi_j(t_n)+\frac{D}{2}\mathbf{g}_{\mathrm{s}}\mathbf{h}_{n,k}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.417em;vertical-align:-0.4358em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.4358em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord >Φ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.2173em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8723em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf">h</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>&#41;</p>
<p>The middle panel shows the projected travel-time residuals subtracting the deep gradient contribution &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msubsup><mi>T</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow><mrow><mi mathvariant=normal >o</mi><mi mathvariant=normal >b</mi><mi mathvariant=normal >s</mi></mrow></msubsup><mo>−</mo><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msup><mi>T</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi mathvariant=bold >p</mi><mi>k</mi></msub><mo>+</mo><mi>δ</mi><mi mathvariant=bold >p</mi><mo separator=true >,</mo><mi mathvariant=bold >u</mi><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo separator=true >,</mo><msub><mi mathvariant=bold >b</mi><mn>0</mn></msub><mo fence=true >)</mo></mrow><mo separator=true >,</mo><msub><mi>v</mi><mn>0</mn></msub><mo fence=true >)</mo></mrow><mo>−</mo><mfrac><mi>D</mi><mn>2</mn></mfrac><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub><msub><mi mathvariant=bold >h</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\frac{1}{M\left(\xi_{n,k}\right)} T_{n,k}^{\mathrm{obs}}-\frac{1}{M\left(\xi_{n,k}\right)} {T}^{\mathrm{cal}}\left(\mathbf{p}_k+\delta \mathbf{p}, \mathbf{u}\left(t_{n},{\bf b}_0\right), v_0\right) - \frac{D}{2}\mathbf{g}_{\mathrm{s}}\mathbf{h}_{n,k}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.3972em;vertical-align:-0.5481em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8451em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class=mtight >(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.046em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2901em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class=mtight >)</span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">obs</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.4192em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.3972em;vertical-align:-0.5481em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8451em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class=mtight >(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.046em;margin-right:0.0714em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2901em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class=mtight >)</span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord mathbf">p</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathbf">u</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">b</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.2173em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8723em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf">h</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>&#41; by the cross symbols. Moreover, the 3d B-splined NTD, the long-term NTD, and combination of the long-term NTD and the shallow gradients are shown by black, red, and blue curves, respecively.</p>
<p>The lower panel shows the travel-time residuals in the observation equation 1.</p>
<h2 id=run_mcmc_processing_with_additional_constraints ><a href="#run_mcmc_processing_with_additional_constraints" class=header-anchor >Run MCMC processing with additional constraints</a></h2>
<p>As a developing function, you can perform the MCMC processing with additional constraints. If you have acoustic data obtained from only a fixed-point survey, it is difficult to obtain stable positioning results by <code>static_array_mcmcgrad&#40;&#41;</code> as indicated by <a href="https://earth-planets-space.springeropen.com/articles/10.1186/s40623-022-01740-0">Tomita &amp; Kido &#40;2022&#41;</a>. Here, <code>static_array_mcmcgradc&#40;lat,TR_DEPTH,NPB,ss,gd0,sdg&#41;</code> provides two additional constraints as prior distributions.</p>
<p>One prior distribution is a Cauchy distribution for shallow gradients with the location parameter of zero and the scale parameter of <code>ss</code>. Shallow gradients can be determined by acoustic data obtained by spatially distributed sea-surface platform. Thus, it is plausible to constrain the shallow gradients to be zero for stability when you do not have sufficient spatial distribution of a sea-surface platform. Thus, <code>static_array_mcmcgradc&#40;&#41;</code> provides the Cauchy distribution: if data is insufficient, the shallow gradients are constrained to be zero; if data is sufficient, the shallow gradients are followed with the data apart from zero because a Cauchy distribution allows outliers. <code>ss</code> is set to be 3.e-4 as the default value, considering the results of <a href="https://earth-planets-space.springeropen.com/articles/10.1186/s40623-022-01740-0">Tomita &amp; Kido &#40;2022&#41;</a>.</p>
<p>The other prior distribution is a Normal distribution for the gradient depth with the mean of <code>gd0</code> and the standard deviation of <code>sdg</code>. If the data quantity is insuffient or the data include outliers, the gradient depth tends to have quite small or large value. To avoid this, the prior distribution can constrain the gradient depth. Refering the results of <a href="https://earth-planets-space.springeropen.com/articles/10.1186/s40623-022-01740-0">Tomita &amp; Kido &#40;2022&#41;</a>, <code>gd0&#61;0.65</code> &#91;km&#93; and <code>sgd&#61;0.1</code> &#91;km&#93; are defined as the default values.</p>
<p>The parameters for the prior distributions can be optionally changed as following:</p>
<pre><code class="julia hljs">ss=<span class=hljs-number >5</span>,e-<span class=hljs-number >4</span>; gd0=<span class=hljs-number >0.5</span>; sdg=<span class=hljs-number >0.2</span>
SeaGap.static_array_mcmcgradc(lat,TR_DEPTH,NPB,ss,gd0,sdg,tscale=<span class=hljs-number >10.0</span>)</code></pre>
<p>Formats of the input and output files of <code>static_array_mcmcgradc&#40;&#41;</code> are same with those of <code>static_array_mcmcgrad&#40;&#41;</code>. The options to improve the acceptance ratio in <code>static_array_mcmcgrad&#40;&#41;</code> &#40;e.g., <code>lscale</code>, <code>aventd</code>, and <code>NSB</code>&#41; are also used.</p>
<div class=page-foot >
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Fumiaki Tomita. Last modified: March 24, 2023.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>
</div>
  </main> 
  <script src="/SeaGapDocs/libs/vela/metisMenu.min.js"></script>
  <script src="/SeaGapDocs/libs/vela/slideout.min.js"></script>
  
    



  
  
    <script src="/SeaGapDocs/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>
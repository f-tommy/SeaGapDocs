<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/SeaGapDocs/libs/katex/katex.min.css"> <link rel=stylesheet  href="/SeaGapDocs/libs/highlight/styles/github.min.css"> <link href="/SeaGapDocs/css/franklin.css" rel=stylesheet > <link href="/SeaGapDocs/css/vela.css" rel=stylesheet > <script src="/SeaGapDocs/libs/vela/jquery.min.js"></script> <link rel=icon  href="/SeaGapDocs/assets/favicon.png"> <title>SeaGapDocs</title> <div class="main-nav slideout-menu slideout-menu-left" id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>SeaGap Docs</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/SeaGapDocs/index.html">Home</a> <li><a href="/SeaGapDocs/install/">Installation</a> <li><a href="/SeaGapDocs/dataformat/">Dataformat</a> <li><a href="" class=has-arrow >Methodology</a> <ul> <li><a href="/SeaGapDocs/methodoverview/">Overview</a> </ul> <ul> <li><a href="/SeaGapDocs/methodtt/">Travel-time calculation</a> </ul> <ul> <li><a href="/SeaGapDocs/methodkinematic/">Kinematic array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodstatic/">Static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodsingle/">Individual transponder positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodmcmcpvg/">Static array positioning with gradients</a> </ul> <li><a href="" class=has-arrow >Tutorials</a> <ul> <li><a href="/SeaGapDocs/tutorialforward/">Forward calculation</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialdenoise/">Outlier removal</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialkinematic/">Kinematic array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialstatic/">Static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialmcmcpvg/">MCMC static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialts/">Line fitting for time-series</a> </ul> <li><a href="/SeaGapDocs/others/">Others</a> </ul> </nav> </div> <main id=panel  class="slidout-panel slideout-panel-left"> <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">Others</h1> <hr> <div class=franklin-content > <h1 id=others ><a href="#others" class=header-anchor >Others</a></h1> <p>Documentation for the other usable functions equipped in <a href="https://github.com/f-tommy/SeaGap.jl">SeaGap</a>.</p> <div class=franklin-toc ><ol><li><a href="#site_information_file">Site information file</a><li><a href="#date_time_processing">Date &amp; Time processing</a><ol><li><a href="#date_-_cal">date -&gt; cal</a><li><a href="#date_-_year">date -&gt; year </a><li><a href="#date_-_sec">date -&gt; sec</a><li><a href="#sec_-_date">sec -&gt; date</a><li><a href="#sec_-_year">sec -&gt; year</a></ol><li><a href="#coordinate_transformation">Coordinate transformation</a><ol><li><a href="#longitude_latitude_-_xy">Longitude, Latitude -&gt; XY</a><li><a href="#xy_-_longitude_latitude">XY -&gt; Longitude, Latitude</a></ol><li><a href="#sorting">Sorting</a><li><a href="#running_filter">Running filter</a><li><a href="#simple_inversion">Simple inversion</a><li><a href="#line_fit">Line fit</a></ol></div> <h2 id=site_information_file ><a href="#site_information_file" class=header-anchor >Site information file</a></h2> <p>SeaGap often requires site location; thus, it is convenient to instantly obtain site information. <code>read_info&#40;site,filename&#41;</code> is a simple function to obtain the basic site information from a file <code>filename</code>.</p> <p>If you prepare a following file named &quot;site&#95;info.txt&quot; with the site information &#40;1: Site name, 2: Longitude &#91;deg&#93;, 3: Latitude &#91;deg&#93;, 4: Water depth &#91;m&#93;, 5: Total number of transponders&#41;:</p> <div class=important >&#36; cat site&#95;info.txt</div> <pre><code class="plaintext hljs">G01 144.953750000 38.697035000 5490.2 4
G02 144.047013333 40.737111667 4672.5 4
G03 143.967245000 40.126088333 4218.4 4
G04 143.897145000 39.566171667 4586.5 6
G05 143.316761667 39.325555000 2084.8 4
G06 143.849871667 39.302598333 4770.4 4
G07 143.940026667 38.942755000 5550.4 3
G08 143.647465000 38.721148333 3473.1 4
G09 143.791663333 38.480898333 5646.5 4
G10 143.482881667 38.301606667 3270.8 6
G11 143.801736667 38.266500000 5548.5 4
G12 143.531633333 38.020813333 4370.4 3
G13 143.198573333 37.932891667 2480.5 4
G14 142.774661667 37.891595000 1312.0 4
G15 143.520901667 37.677226667 5263.9 6
G16 143.048235000 37.333650000 4406.7 4
G17 142.715440000 36.899033333 4232.4 4
G18 141.982523333 36.615520000 2490.6 4
G19 142.670803333 36.496250000 5724.8 6
G20 142.082610000 36.157530000 2742.7 4</code></pre> <p>you can obtain the values at a certain site <code>site</code> as following:</p> <pre><code class="julia-repl hljs"><span class="hljs-meta prompt_">julia&gt;</span><span class=language-julia > lon, lat, wd, numk = SeaGap.read_info(<span class=hljs-string >&quot;G20&quot;</span>,<span class=hljs-string >&quot;site_info.txt&quot;</span>)
</span>(142.08261, 36.15753, 2742.7, 4)
<span class="hljs-meta prompt_">julia&gt;</span><span class=language-julia > lat
</span>36.15753</code></pre> <h2 id=date_time_processing ><a href="#date_time_processing" class=header-anchor >Date &amp; Time processing</a></h2> <h3 id=date_-_cal ><a href="#date_-_cal" class=header-anchor >date -&gt; cal</a></h3> <p><code>date2cal&#40;&#41;</code> transforms &quot;date&quot; into &quot;cumulative days in year&quot;.</p> <pre><code class="julia hljs">year, cal = SeaGap.date2cal(<span class=hljs-string >&quot;2015-10-01&quot;</span>)
(<span class=hljs-number >2015</span>, <span class=hljs-number >274</span>)</code></pre> <p>If you use this function as <code>date2cal.&#40;&#41;</code>, you can handle a vector input and transform multiple values.</p> <p>Moreover, <code>date2cal_txt&#40;fn0,fn&#41;</code> reads a text file &#40;<code>fn0</code> is the input file name&#41; with dates in the first row and writes a text file &#40;<code>fn</code> is the output file name&#41; after transformation.</p> <p>If preparing the following text file:</p> <div class=important >&#36; cat test01.txt</div> <pre><code class="plaintext hljs">2015-10-10T12:00:00 100
2015-12-10T12:00:00 200
2016-02-10T12:00:00 300</code></pre> <p>and performing the following:</p> <pre><code class="julia hljs">SeaGap.date2cal_txt(<span class=hljs-string >&quot;test01.txt&quot;</span>,<span class=hljs-string >&quot;test1.txt&quot;</span>)</code></pre>
<p>you can obtain the following output file:</p>
<div class=important >&#36; cat test1.txt</div>
<pre><code class="plaintext hljs">2015 283 100
2015 344 200
2016 041 300</code></pre>
<h3 id=date_-_year ><a href="#date_-_year" class=header-anchor >date -&gt; year </a></h3>
<p><code>date2year&#40;&#41;</code> transforms &quot;date&quot; into &quot;year&quot;.</p>
<pre><code class="julia hljs">year, cal = SeaGap.date2year(<span class=hljs-string >&quot;2015-10-01&quot;</span>)
<span class=hljs-number >2015.7506849315068</span></code></pre>
<p>If you use this function as <code>date2year.&#40;&#41;</code>, you can handle a vector input and transform multiple values.</p>
<p>Moreover, <code>date2year_txt&#40;fn0,fn&#41;</code> reads a text file &#40;<code>fn0</code> is the input file name&#41; with dates in the first row and writes a text file &#40;<code>fn</code> is the output file name&#41; after transformation.</p>
<p>If preparing the above text file &#40;test01.txt&#41; and performing the following:</p>
<pre><code class="julia hljs">SeaGap.date2year_txt(<span class=hljs-string >&quot;test01.txt&quot;</span>,<span class=hljs-string >&quot;test1.txt&quot;</span>)</code></pre>
<p>you can obtain the following output file:</p>
<div class=important >&#36; cat test1.txt</div>
<pre><code class="plaintext hljs">2015.775342465754 100
2015.942465753425 200
2016.112021857924 300</code></pre>
<h3 id=date_-_sec ><a href="#date_-_sec" class=header-anchor >date -&gt; sec</a></h3>
<p><code>date2sec&#40;t,t0&#41;</code> transforms &quot;date&quot; into &quot;cumulative seconds from the reference date&quot;. The reference date <code>t0</code> is set to 2000-01-01T12:00:00 as the defalt value.</p>
<pre><code class="julia hljs">sec = SeaGap.date2sec(<span class=hljs-string >&quot;2015-10-01T12:34:56&quot;</span>)
<span class=hljs-number >4.96974896e8</span>
sec = SeaGap.date2sec(<span class=hljs-string >&quot;2015-10-01T12:34:56&quot;</span>,t0=<span class=hljs-string >&quot;2015-01-01T12:00:00&quot;</span>)
<span class=hljs-number >2.3589296e7</span></code></pre>
<p>If you use this function as <code>date2sec.&#40;&#41;</code>, you can handle a vector input and transform multiple values.</p>
<p>Moreover, <code>date2sec_txt&#40;fn0,fn,t0&#41;</code> reads a text file &#40;<code>fn0</code> is the input file name&#41; with dates in the first row and writes a text file &#40;<code>fn</code> is the output file name&#41; after transformation.</p>
<p>If preparing the above text file &#40;test01.txt&#41; and performing the following:</p>
<pre><code class="julia hljs">SeaGap.date2sec_txt(<span class=hljs-string >&quot;test01.txt&quot;</span>,<span class=hljs-string >&quot;test1.txt&quot;</span>)</code></pre>
<p>you can obtain the following output file:</p>
<div class=important >&#36; cat test1.txt</div>
<pre><code class="plaintext hljs">497750400.000000 100
503020800.000000 200
508377600.000000 300</code></pre>
<h3 id=sec_-_date ><a href="#sec_-_date" class=header-anchor >sec -&gt; date</a></h3>
<p><code>sec2date&#40;t,t0&#41;</code> and <code>sec2date_txt&#40;fn0,fn,t0&#41;</code> work as reverse functions of <code>date2sec&#40;t,t0&#41;</code> and <code>date2sec_txt&#40;fn0,fn,t0&#41;</code>, respectively.</p>
<h3 id=sec_-_year ><a href="#sec_-_year" class=header-anchor >sec -&gt; year</a></h3>
<p><code>sec2year&#40;t,t0&#41;</code> and <code>sec2year_txt&#40;fn0,fn,t0&#41;</code> convert &quot;cumulative seconds from the reference date&quot; into &quot;year&quot;. The reference date <code>t0</code> is set to 2000-01-01T12:00:00 as the defalt value.</p>
<pre><code class="julia hljs">SeaGap.sec2year(<span class=hljs-number >4.969728e8</span>)
<span class=hljs-number >2015.7506849315068</span></code></pre>
<p>If preparing the following text file &#40;test02.txt&#41;</p>
<pre><code class="plaintext hljs">497750400.000000 100
503020800.000000 200
508377600.000000 300</code></pre>
<p>and performing the following:</p>
<pre><code class="julia hljs">SeaGap.sec2year_txt(<span class=hljs-string >&quot;test02.txt&quot;</span>,<span class=hljs-string >&quot;test2.txt&quot;</span>)</code></pre>
<p>you can obtain the following output file:</p>
<div class=important >&#36; cat test2.txt</div>
<pre><code class="plaintext hljs">2015.775342465754 100
2015.942465753425 200
2016.112021857924 300</code></pre>
<h2 id=coordinate_transformation ><a href="#coordinate_transformation" class=header-anchor >Coordinate transformation</a></h2>
<p>SeaGap perform coordinate transformation between geographic coordinate and a projection coordinate by &quot;mapproject&quot; module in <a href="https://github.com/GenericMappingTools/GMT.jl">GMT</a>. The projection system is Transverse Mercator &#40;-Jt&#41;.</p>
<h3 id=longitude_latitude_-_xy ><a href="#longitude_latitude_-_xy" class=header-anchor >Longitude, Latitude -&gt; XY</a></h3>
<p><code>ll2xy&#40;lon,lat,lon0,lat0&#41;</code> transforms the geographic coordinate &#40;<code>lon</code> and <code>lat</code>&#41; into the projection coordinate with the projection center of &#40;<code>lon0</code>, <code>lat0</code>&#41;</p>
<pre><code class="julia hljs">x, y = SeaGap.ll2xy(<span class=hljs-number >139.01</span>,<span class=hljs-number >37.99</span>,<span class=hljs-number >139</span>,<span class=hljs-number >38</span>)
(<span class=hljs-number >878.4438672769625</span>, -<span class=hljs-number >1109.9166351306528</span>)</code></pre>
<p>If you&#39;d like to transform multiple values, you can use <code>ll2xy_vec&#40;lon,lat,lon0,lat0&#41;</code>. In this case, <code>lon</code> and <code>lat</code> are vectors with the same dimensions.</p>
<p>If you&#39;d like to transform multiple values via a text file, you can use <code>ll2xy_txt&#40;fn0,fn,ks,lon0,lat0&#41;</code>. <code>fn0</code> is the input file written in the geographic coordinate, and <code>fn</code> is the output file written in the projected coordinate. <code>ks</code> is an identifer for the longitude row. If the longitude and latitude are shown in the rows 1 and 2, you set <code>ks&#61;1</code>; if the longitude and latitude are shown in the rows 3 and 4, you set <code>ks&#61;3</code>.</p>
<div class=important >&#36; head gps.jllhpr</div>
<pre><code class="plaintext hljs">500663320.00 142.077767915 36.182468927 27.875250 -4.5784 -1.4752 0.2540
500663320.50 142.077771912 36.182447992 27.644200 -4.4348 -1.0296 -0.5176
500663321.00 142.077775355 36.182427602 27.533200 -4.2144 -0.8856 -1.0988
500663321.50 142.077778539 36.182407813 27.577200 -3.9376 -1.0300 -1.4052
500663322.00 142.077782024 36.182388370 27.688650 -3.6868 -1.2688 -1.4408
500663322.50 142.077786287 36.182368782 27.709300 -3.5284 -1.3532 -1.2196
500663323.00 142.077791670 36.182348941 27.534550 -3.4464 -1.1888 -0.7060
500663323.50 142.077797880 36.182329011 27.240900 -3.3472 -0.8852 0.0952
500663324.00 142.077804425 36.182309198 26.938300 -3.1948 -0.6000 1.0656
500663324.50 142.077810868 36.182289402 26.737900 -3.0584 -0.3556 1.9636</code></pre>
<p>The above file can be transformed as following:</p>
<pre><code class="julia hljs">SeaGap.ll2xy_txt(<span class=hljs-string >&quot;gps.jllhhpr&quot;</span>,<span class=hljs-string >&quot;hoge.txt&quot;</span>,<span class=hljs-number >2</span>,<span class=hljs-number >142.082610</span>,<span class=hljs-number >36.157530</span>)</code></pre>
<div class=important >&#36; head hoge.txt</div>
<pre><code class="plaintext hljs">500663320.00 -435.572296 2767.287953 27.875250 -4.5784 -1.4752 0.2540
500663320.50 -435.212860 2764.964938 27.644200 -4.4348 -1.0296 -0.5176
500663321.00 -434.903255 2762.702399 27.533200 -4.2144 -0.8856 -1.0988
500663321.50 -434.616946 2760.506550 27.577200 -3.9376 -1.0300 -1.4052
500663322.00 -434.303558 2758.349093 27.688650 -3.6868 -1.2688 -1.4408
500663322.50 -433.920185 2756.175543 27.709300 -3.5284 -1.3532 -1.2196
500663323.00 -433.436064 2753.973914 27.534550 -3.4464 -1.1888 -0.7060
500663323.50 -432.877549 2751.762406 27.240900 -3.3472 -0.8852 0.0952
500663324.00 -432.288897 2749.563879 26.938300 -3.1948 -0.6000 1.0656
500663324.50 -431.709421 2747.367239 26.737900 -3.0584 -0.3556 1.9636</code></pre>
<h3 id=xy_-_longitude_latitude ><a href="#xy_-_longitude_latitude" class=header-anchor >XY -&gt; Longitude, Latitude</a></h3>
<p>In SeaGap, the reverse functions for <code>ll2xy&#40;&#41;</code>,<code>ll2xy_vec&#40;&#41;</code>, and <code>ll2xy_txt&#40;&#41;</code> are provided as <code>xy2ll&#40;&#41;</code>, <code>xy2ll_vec&#40;&#41;</code>, and <code>xy2ll_txt&#40;&#41;</code>, respectively.</p>
<h2 id=sorting ><a href="#sorting" class=header-anchor >Sorting</a></h2>
<p>As for the tuple type, Julia&#39;s sort function works as similar with Unix&#39;s sort command &#40;if you sort for one certain column, the other columns are also sorted following the certain column&#39;s order&#41;. However, as for the array or matrix types, Julia&#39;s sort function works differently &#40;only the selected column is sorted&#41;. Then, SeaGap provides new sort functions <code>unixsort&#40;x,k&#41;</code> and <code>unixsort2&#40;x,k1,k2&#41;</code> which also works for the array and matrix types as similar with Unix&#39;s sort command but only works for numerical values.<code>x</code> is array or matrix, and <code>k</code> is number of the column to be sorted. As for <code>unixsort2&#40;x,k1,k2&#41;</code>, <code>k1</code> is the primary column to be sorted and <code>k2</code> is the secondary column to be sorted.</p>
<pre><code class="julia hljs">a = hcat(round.(rand(<span class=hljs-number >10</span>)),rand(<span class=hljs-number >10</span>,<span class=hljs-number >3</span>))
<span class=hljs-number >10</span>×<span class=hljs-number >4</span> <span class=hljs-built_in >Matrix</span>{<span class=hljs-built_in >Float64</span>}:
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.825768</span>   <span class=hljs-number >0.43119</span>    <span class=hljs-number >0.915429</span>
 <span class=hljs-number >0.0</span>  <span class=hljs-number >0.136709</span>   <span class=hljs-number >0.520284</span>   <span class=hljs-number >0.171813</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.579633</span>   <span class=hljs-number >0.911675</span>   <span class=hljs-number >0.364961</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.0203354</span>  <span class=hljs-number >0.616683</span>   <span class=hljs-number >0.515084</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.605135</span>   <span class=hljs-number >0.56349</span>    <span class=hljs-number >0.808185</span>
 <span class=hljs-number >0.0</span>  <span class=hljs-number >0.448877</span>   <span class=hljs-number >0.710546</span>   <span class=hljs-number >0.130922</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.426983</span>   <span class=hljs-number >0.43761</span>    <span class=hljs-number >0.369329</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.280084</span>   <span class=hljs-number >0.641669</span>   <span class=hljs-number >0.163034</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.199115</span>   <span class=hljs-number >0.896918</span>   <span class=hljs-number >0.224157</span>
 <span class=hljs-number >0.0</span>  <span class=hljs-number >0.402337</span>   <span class=hljs-number >0.0203177</span>  <span class=hljs-number >0.600175</span></code></pre>
<pre><code class="julia hljs">a_new = SeaGap.unixsort(a,<span class=hljs-number >2</span>)
<span class=hljs-number >10</span>×<span class=hljs-number >4</span> <span class=hljs-built_in >Matrix</span>{<span class=hljs-built_in >Float64</span>}:
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.0203354</span>  <span class=hljs-number >0.616683</span>   <span class=hljs-number >0.515084</span>
 <span class=hljs-number >0.0</span>  <span class=hljs-number >0.136709</span>   <span class=hljs-number >0.520284</span>   <span class=hljs-number >0.171813</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.199115</span>   <span class=hljs-number >0.896918</span>   <span class=hljs-number >0.224157</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.280084</span>   <span class=hljs-number >0.641669</span>   <span class=hljs-number >0.163034</span>
 <span class=hljs-number >0.0</span>  <span class=hljs-number >0.402337</span>   <span class=hljs-number >0.0203177</span>  <span class=hljs-number >0.600175</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.426983</span>   <span class=hljs-number >0.43761</span>    <span class=hljs-number >0.369329</span>
 <span class=hljs-number >0.0</span>  <span class=hljs-number >0.448877</span>   <span class=hljs-number >0.710546</span>   <span class=hljs-number >0.130922</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.579633</span>   <span class=hljs-number >0.911675</span>   <span class=hljs-number >0.364961</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.605135</span>   <span class=hljs-number >0.56349</span>    <span class=hljs-number >0.808185</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.825768</span>   <span class=hljs-number >0.43119</span>    <span class=hljs-number >0.915429</span></code></pre>
<pre><code class="julia hljs">a_new = SeaGap.unixsort2(a,<span class=hljs-number >1</span>,<span class=hljs-number >3</span>)
<span class=hljs-number >10</span>×<span class=hljs-number >4</span> <span class=hljs-built_in >Matrix</span>{<span class=hljs-built_in >Float64</span>}:
 <span class=hljs-number >0.0</span>  <span class=hljs-number >0.402337</span>   <span class=hljs-number >0.0203177</span>  <span class=hljs-number >0.600175</span>
 <span class=hljs-number >0.0</span>  <span class=hljs-number >0.136709</span>   <span class=hljs-number >0.520284</span>   <span class=hljs-number >0.171813</span>
 <span class=hljs-number >0.0</span>  <span class=hljs-number >0.448877</span>   <span class=hljs-number >0.710546</span>   <span class=hljs-number >0.130922</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.825768</span>   <span class=hljs-number >0.43119</span>    <span class=hljs-number >0.915429</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.426983</span>   <span class=hljs-number >0.43761</span>    <span class=hljs-number >0.369329</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.605135</span>   <span class=hljs-number >0.56349</span>    <span class=hljs-number >0.808185</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.0203354</span>  <span class=hljs-number >0.616683</span>   <span class=hljs-number >0.515084</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.280084</span>   <span class=hljs-number >0.641669</span>   <span class=hljs-number >0.163034</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.199115</span>   <span class=hljs-number >0.896918</span>   <span class=hljs-number >0.224157</span>
 <span class=hljs-number >1.0</span>  <span class=hljs-number >0.579633</span>   <span class=hljs-number >0.911675</span>   <span class=hljs-number >0.364961</span></code></pre>
<h2 id=running_filter ><a href="#running_filter" class=header-anchor >Running filter</a></h2>
<p>SeaGap provides simple running &#40;moving&#41; filters: <code>runmed&#40;x,k&#41;</code> and <code>runave&#40;x,k&#41;</code> which are a running median filter and a running average filter, respectively. Both functions smooth the input numerical vector <code>x</code> by <code>k</code> length of a running window.</p>
<p>Preparing input data with 1-dimension array:</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions
t = collect(range(<span class=hljs-number >1</span>,<span class=hljs-number >10</span>,<span class=hljs-number >10</span>))
a = collect(range(<span class=hljs-number >1</span>,<span class=hljs-number >10</span>,<span class=hljs-number >10</span>))+rand(Cauchy(),<span class=hljs-number >10</span>)
<span class=hljs-number >10</span>-element <span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >Float64</span>}:
  <span class=hljs-number >0.9713071965257543</span>
  <span class=hljs-number >3.4732347973689537</span>
  <span class=hljs-number >2.3512497164125667</span>
  <span class=hljs-number >4.076701783766254</span>
 <span class=hljs-number >15.169399082762245</span>
 -<span class=hljs-number >7.814884216883062</span>
  <span class=hljs-number >7.515355534078403</span>
  <span class=hljs-number >7.350965798485638</span>
  <span class=hljs-number >9.776065411160495</span>
  <span class=hljs-number >9.200257419697813</span></code></pre>
<p>Performing the running median and average filters with 3 length running window:</p>
<pre><code class="julia hljs">a_med = SeaGap.runmed(a,<span class=hljs-number >3</span>)
a_ave = SeaGap.runave(a,<span class=hljs-number >3</span>)</code></pre>
<p>Plotting the results:</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Plots
plt = plot(t,a,label=<span class=hljs-string >&quot;Raw&quot;</span>)
plot!(plt,t,a_med,label=<span class=hljs-string >&quot;Median&quot;</span>)
plot!(plt,t,a_ave,label=<span class=hljs-string >&quot;Average&quot;</span>)
savefig(plt,<span class=hljs-string >&quot;filter_test.png&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/filter_test.png" width=300  height=300 >
    <div style="clear: both"></div>
  </div>
</div>

<h2 id=simple_inversion ><a href="#simple_inversion" class=header-anchor >Simple inversion</a></h2>
<p><code>simple_inversion&#40;d,H&#41;</code> is a function performing a simple least mean squares method. <code>d</code> is a data vector, and <code>H</code> is a kernel matrix. The obervation equation is given using a solution vector <code>a</code> as following:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi mathvariant=bold >d</mi><mo>=</mo><mrow><mi mathvariant=bold >H</mi><mi mathvariant=bold >a</mi></mrow><mo>+</mo><msub><mi mathvariant=bold >e</mi><mrow><mi mathvariant=normal >o</mi><mi mathvariant=normal >b</mi><mi mathvariant=normal >s</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> \bf{ d}={\bf Ha}+{\bf e}_{\rm obs} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8444em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">d</span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">Ha</span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">e</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">obs</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p><code>a</code> is simply obtained as:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mover accent=true ><mi mathvariant=bold >a</mi><mo>^</mo></mover><mo>=</mo><msup><mrow><mo fence=true >(</mo><msup><mi mathvariant=bold >H</mi><mi mathvariant=normal >T</mi></msup><mi mathvariant=bold >H</mi><mo fence=true >)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mi mathvariant=bold >H</mi><mi mathvariant=bold >d</mi></mrow></mrow><annotation encoding="application/x-tex"> \hat{\bf a}=\left({\bf H}^{\rm T}{\bf H}\right)^{-1}{\bf Hd} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7079em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7079em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathbf">a</span></span></span><span style="top:-3.0134em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.25em;"><span class=mord >^</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.4453em;vertical-align:-0.35em;"></span><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">H</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord mathbf">H</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.0953em;"><span style="top:-3.3442em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">Hd</span></span></span></span></span></span></span>
<p>Then, we can calculate a synthetic data vector as <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >d</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub><mo>=</mo><mi mathvariant=bold >H</mi><mover accent=true ><mi mathvariant=bold >a</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">{\bf d}_{\rm cal}={\bf H}\hat{\bf a}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8444em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">d</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.7079em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">H</span></span></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7079em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathbf">a</span></span></span><span style="top:-3.0134em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.25em;"><span class=mord >^</span></span></span></span></span></span></span></span></span></span> and a residual vector as <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >d</mi><mrow><mi mathvariant=normal >r</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >s</mi></mrow></msub><mo>=</mo><mi mathvariant=bold >d</mi><mo>−</mo><msub><mi mathvariant=bold >d</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\bf d}_{\rm res}={\bf d}-{\bf d}_{\rm cal}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8444em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">d</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">res</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.7778em;vertical-align:-0.0833em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">d</span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.8444em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">d</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. Moreover, we can calculate covariance matrix for the estimated paramters as:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi mathvariant=bold >C</mi><mo>=</mo><msup><mi>σ</mi><mn>2</mn></msup><msup><mrow><mo fence=true >(</mo><msup><mi mathvariant=bold >H</mi><mi mathvariant=normal >T</mi></msup><mi mathvariant=bold >H</mi><mo fence=true >)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex"> {\bf C}={\sigma}^2\left({\bf H}^{\rm T}{\bf H}\right)^{-1} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6861em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">C</span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.4453em;vertical-align:-0.35em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">H</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord mathbf">H</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.0953em;"><span style="top:-3.3442em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>with</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mrow><mi>N</mi><mo>−</mo><mi>M</mi></mrow></mfrac><msup><msub><mi mathvariant=bold >d</mi><mrow><mi mathvariant=normal >r</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >s</mi></mrow></msub><mi mathvariant=normal >T</mi></msup><msub><mi mathvariant=bold >d</mi><mrow><mi mathvariant=normal >r</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >s</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> {\sigma}^2=\frac{1}{N-M}{\bf d_{\rm res}}^{\rm T}{\bf d_{\rm res}} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8641em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.0908em;vertical-align:-0.7693em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">d</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">res</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9257em;"><span style="top:-3.1473em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">d</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">res</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>Note that <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> is the length of the data and model vectors,respectively. Then, we can obtain a standard deviation vector <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >e</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mrow><mo fence=true >(</mo><mi mathvariant=bold >C</mi><mo fence=true >)</mo></mrow></mrow><annotation encoding="application/x-tex">{\bf e}_{\rm cal}=diag\left({\bf C}\right)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5944em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">e</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">ia</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class=mord ><span class="mord mathbf">C</span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>. <code>simple_inversion&#40;d,H&#41;</code> returns the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >d</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\bf d}_{\rm cal}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8444em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">d</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >d</mi><mrow><mi mathvariant=normal >r</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\bf d}_{\rm res}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8444em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">d</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">res</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold >a</mi></mrow><annotation encoding="application/x-tex">{\bf a}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4444em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">a</span></span></span></span></span></span>, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >e</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\bf e}_{\rm cal}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5944em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">e</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<pre><code class="julia hljs">dcal, dres, a, e = SeaGap.simple_inversion(d,H)</code></pre>
<h2 id=line_fit ><a href="#line_fit" class=header-anchor >Line fit</a></h2>
<p><code>linefit&#40;x,y,w0;alpha,newX&#41;</code> is a function of a least squares method for simple line fitting: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold >y</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>B</mi><mi mathvariant=bold >x</mi></mrow><annotation encoding="application/x-tex">{\bf y}=A+B{\bf x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6389em;vertical-align:-0.1944em;"></span><span class=mord ><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class=mord ><span class=mord ><span class="mord mathbf">x</span></span></span></span></span></span>. <code>x</code> and <code>y</code> are vectors with the same length, and they must be occupied. <code>wo</code> is a weight vector, and you can optionally use it. <code>alpha</code> is a real value with range between 0 and 1, and <code>alpha</code>&#42;100 indicates the percentage for confidentional intervals; <code>linefit&#40;&#41;</code> provides the upper and lower confidentional intervals for the fitting line. The default <code>alpha</code> is set to be 0.95, which means 95&#37; CI. <code>newX</code> is an optional vector; if you assign <code>newX</code>, the predicted values, the upper and lower confidentional intervals following <code>newX</code> are provided: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >y</mi><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >r</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >d</mi></mrow></msub><mo>=</mo><mover accent=true ><mi>A</mi><mo>^</mo></mover><mo>+</mo><mover accent=true ><mi>B</mi><mo>^</mo></mover><msub><mi mathvariant=bold >x</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\bf y}_{\rm pred}=\hat{A}+\hat{B}{\bf x}_{new}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7305em;vertical-align:-0.2861em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">pred</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.0301em;vertical-align:-0.0833em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9468em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.1111em;"><span class=mord >^</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.0968em;vertical-align:-0.15em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9468em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-3.2523em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.1667em;"><span class=mord >^</span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<p>If you have following vectors:</p>
<pre><code class="julia hljs">julia&gt; t
<span class=hljs-number >10</span>-element <span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >Float64</span>}:
  <span class=hljs-number >1.0</span>
  <span class=hljs-number >2.0</span>
  <span class=hljs-number >3.0</span>
  <span class=hljs-number >4.0</span>
  <span class=hljs-number >5.0</span>
  <span class=hljs-number >6.0</span>
  <span class=hljs-number >7.0</span>
  <span class=hljs-number >8.0</span>
  <span class=hljs-number >9.0</span>
 <span class=hljs-number >10.0</span></code></pre>
<pre><code class="julia hljs">julia&gt; a
<span class=hljs-number >10</span>-element <span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >Float64</span>}:
  <span class=hljs-number >0.9713071965257543</span>
  <span class=hljs-number >3.4732347973689537</span>
  <span class=hljs-number >2.3512497164125667</span>
  <span class=hljs-number >4.076701783766254</span>
 <span class=hljs-number >15.169399082762245</span>
 -<span class=hljs-number >7.814884216883062</span>
  <span class=hljs-number >7.515355534078403</span>
  <span class=hljs-number >7.350965798485638</span>
  <span class=hljs-number >9.776065411160495</span>
  <span class=hljs-number >9.200257419697813</span></code></pre>
<pre><code class="julia hljs">julia&gt; t_new = collect(range(<span class=hljs-number >1</span>,<span class=hljs-number >10</span>,<span class=hljs-number >20</span>))
<span class=hljs-number >20</span>-element <span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >Float64</span>}:
  <span class=hljs-number >1.0</span>
  <span class=hljs-number >1.4736842105263157</span>
  <span class=hljs-number >1.9473684210526316</span>
  <span class=hljs-number >2.4210526315789473</span>
  <span class=hljs-number >2.8947368421052633</span>
  <span class=hljs-number >3.3684210526315788</span>
  <span class=hljs-number >3.8421052631578947</span>
  <span class=hljs-number >4.315789473684211</span>
  <span class=hljs-number >4.7894736842105265</span>
  <span class=hljs-number >5.2631578947368425</span>
  <span class=hljs-number >5.7368421052631575</span>
  <span class=hljs-number >6.2105263157894735</span>
  <span class=hljs-number >6.684210526315789</span>
  <span class=hljs-number >7.157894736842105</span>
  <span class=hljs-number >7.631578947368421</span>
  <span class=hljs-number >8.105263157894736</span>
  <span class=hljs-number >8.578947368421053</span>
  <span class=hljs-number >9.052631578947368</span>
  <span class=hljs-number >9.526315789473685</span>
 <span class=hljs-number >10.0</span></code></pre>
<p>you can perform the line fitting without wights as following:</p>
<pre><code class="julia hljs">lf = SeaGap.linefit(t,a,newX=t_new)</code></pre>
<p>In the above case, <code>lf</code> contains the whole estimation results. <code>lf.coef</code> has the estimated coefficients for <code>A</code> and <code>B</code></p>
<pre><code class="julia hljs">A, B = lf.coef
<span class=hljs-number >2</span>-element <span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >Float64</span>}:
 <span class=hljs-number >0.8566110967793089</span>
 <span class=hljs-number >0.7909734828287631</span></code></pre>
<p><code>lf.coefstd</code> has standard deviations for the estimated coefficients of <code>A</code> and <code>B</code></p>
<pre><code class="julia hljs">A_std, B_std = lf.coefstd
<span class=hljs-number >2</span>-element <span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >Float64</span>}:
 <span class=hljs-number >4.1435872512068945</span>
 <span class=hljs-number >0.6677995520930635</span></code></pre>
<p><code>lf.pred</code> and <code>lf.misfit</code> are prediction and misfit values:</p>
<pre><code class="julia hljs">hcat(t,lf.pred,lf.misfit)
<span class=hljs-number >10</span>×<span class=hljs-number >3</span> <span class=hljs-built_in >Matrix</span>{<span class=hljs-built_in >Float64</span>}:
  <span class=hljs-number >1.0</span>  <span class=hljs-number >1.64758</span>   -<span class=hljs-number >0.676277</span>
  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.43856</span>    <span class=hljs-number >1.03468</span>
  <span class=hljs-number >3.0</span>  <span class=hljs-number >3.22953</span>   -<span class=hljs-number >0.878282</span>
  <span class=hljs-number >4.0</span>  <span class=hljs-number >4.02051</span>    <span class=hljs-number >0.0561968</span>
  <span class=hljs-number >5.0</span>  <span class=hljs-number >4.81148</span>   <span class=hljs-number >10.3579</span>
  <span class=hljs-number >6.0</span>  <span class=hljs-number >5.60245</span>  -<span class=hljs-number >13.4173</span>
  <span class=hljs-number >7.0</span>  <span class=hljs-number >6.39343</span>    <span class=hljs-number >1.12193</span>
  <span class=hljs-number >8.0</span>  <span class=hljs-number >7.1844</span>     <span class=hljs-number >0.166567</span>
  <span class=hljs-number >9.0</span>  <span class=hljs-number >7.97537</span>    <span class=hljs-number >1.80069</span>
 <span class=hljs-number >10.0</span>  <span class=hljs-number >8.76635</span>    <span class=hljs-number >0.433911</span></code></pre>
<p><code>lf.pred_new</code>, <code>lf.pred_upper</code>, and <code>lf.pred_lower</code> are prediction, the upper and lower confidential intervals following <code>newX</code>, respectively:</p>
<pre><code class="julia hljs">hcat(t_new,lf.pred_new,lf.pred_upper,lf.pred_lower)
<span class=hljs-number >20</span>×<span class=hljs-number >4</span> <span class=hljs-built_in >Matrix</span>{<span class=hljs-built_in >Float64</span>}:
  <span class=hljs-number >1.0</span>      <span class=hljs-number >1.64758</span>   <span class=hljs-number >9.86866</span>  -<span class=hljs-number >6.57349</span>
  <span class=hljs-number >1.47368</span>  <span class=hljs-number >2.02226</span>   <span class=hljs-number >9.63858</span>  -<span class=hljs-number >5.59406</span>
  <span class=hljs-number >1.94737</span>  <span class=hljs-number >2.39693</span>   <span class=hljs-number >9.43218</span>  -<span class=hljs-number >4.63833</span>
  <span class=hljs-number >2.42105</span>  <span class=hljs-number >2.7716</span>    <span class=hljs-number >9.25585</span>  -<span class=hljs-number >3.71265</span>
  <span class=hljs-number >2.89474</span>  <span class=hljs-number >3.14627</span>   <span class=hljs-number >9.1179</span>   -<span class=hljs-number >2.82535</span>
  <span class=hljs-number >3.36842</span>  <span class=hljs-number >3.52094</span>   <span class=hljs-number >9.02906</span>  -<span class=hljs-number >1.98717</span>
  <span class=hljs-number >3.84211</span>  <span class=hljs-number >3.89561</span>   <span class=hljs-number >9.00272</span>  -<span class=hljs-number >1.2115</span>
  <span class=hljs-number >4.31579</span>  <span class=hljs-number >4.27029</span>   <span class=hljs-number >9.05463</span>  -<span class=hljs-number >0.514063</span>
  <span class=hljs-number >4.78947</span>  <span class=hljs-number >4.64496</span>   <span class=hljs-number >9.20145</span>   <span class=hljs-number >0.0884669</span>
  <span class=hljs-number >5.26316</span>  <span class=hljs-number >5.01963</span>   <span class=hljs-number >9.45781</span>   <span class=hljs-number >0.581452</span>
  <span class=hljs-number >5.73684</span>  <span class=hljs-number >5.3943</span>    <span class=hljs-number >9.83248</span>   <span class=hljs-number >0.956124</span>
  <span class=hljs-number >6.21053</span>  <span class=hljs-number >5.76897</span>  <span class=hljs-number >10.3255</span>    <span class=hljs-number >1.21248</span>
  <span class=hljs-number >6.68421</span>  <span class=hljs-number >6.14364</span>  <span class=hljs-number >10.928</span>     <span class=hljs-number >1.3593</span>
  <span class=hljs-number >7.15789</span>  <span class=hljs-number >6.51832</span>  <span class=hljs-number >11.6254</span>    <span class=hljs-number >1.41121</span>
  <span class=hljs-number >7.63158</span>  <span class=hljs-number >6.89299</span>  <span class=hljs-number >12.4011</span>    <span class=hljs-number >1.38487</span>
  <span class=hljs-number >8.10526</span>  <span class=hljs-number >7.26766</span>  <span class=hljs-number >13.2393</span>    <span class=hljs-number >1.29603</span>
  <span class=hljs-number >8.57895</span>  <span class=hljs-number >7.64233</span>  <span class=hljs-number >14.1266</span>    <span class=hljs-number >1.15808</span>
  <span class=hljs-number >9.05263</span>  <span class=hljs-number >8.017</span>    <span class=hljs-number >15.0523</span>    <span class=hljs-number >0.981748</span>
  <span class=hljs-number >9.52632</span>  <span class=hljs-number >8.39167</span>  <span class=hljs-number >16.008</span>     <span class=hljs-number >0.775353</span>
 <span class=hljs-number >10.0</span>      <span class=hljs-number >8.76635</span>  <span class=hljs-number >16.9874</span>    <span class=hljs-number >0.54527</span></code></pre>
<p>Plotting them as:</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Plots
plt = scatter(t,a,label=<span class=hljs-string >&quot;Raw&quot;</span>)
plot!(plt,t,lf.pred,label=<span class=hljs-string >&quot;Prediction&quot;</span>)
plot!(plt,t_new,lf.pred_upper,label=<span class=hljs-string >&quot;Upper CI&quot;</span>)
plot!(plt,t_new,lf.pred_lower,label=<span class=hljs-string >&quot;Lower CI&quot;</span>)
savefig(plt,<span class=hljs-string >&quot;line_fit-test.png&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/line_fit-test.png" width=300  height=300 >
    <div style="clear: both"></div>
  </div>
</div>

<div class=page-foot >
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Fumiaki Tomita. Last modified: January 29, 2023.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>
</div>
  </main> 
  <script src="/SeaGapDocs/libs/vela/metisMenu.min.js"></script>
  <script src="/SeaGapDocs/libs/vela/slideout.min.js"></script>
  
    



  
  
    <script src="/SeaGapDocs/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>
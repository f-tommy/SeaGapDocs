<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/SeaGapDocs/libs/highlight/styles/github.min.css"> <link href="/SeaGapDocs/css/franklin.css" rel=stylesheet > <link href="/SeaGapDocs/css/vela.css" rel=stylesheet > <script src="/SeaGapDocs/libs/vela/jquery.min.js"></script> <link rel=icon  href="/SeaGapDocs/assets/favicon.png"> <title>SeaGapDocs</title> <div class="main-nav slideout-menu slideout-menu-left" id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>SeaGap Docs</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/SeaGapDocs/index.html">Home</a> <li><a href="/SeaGapDocs/install/">Installation</a> <li><a href="/SeaGapDocs/dataformat/">Dataformat</a> <li><a href="" class=has-arrow >Methodology</a> <ul> <li><a href="/SeaGapDocs/methodoverview/">Overview</a> </ul> <ul> <li><a href="/SeaGapDocs/methodtt/">Travel-time calculation</a> </ul> <ul> <li><a href="/SeaGapDocs/methodkinematic/">Kinematic array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodstatic/">Static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodsingle/">Individual transponder positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodmcmcpvg/">Static array positioning with gradients</a> </ul> <li><a href="" class=has-arrow >Tutorials</a> <ul> <li><a href="/SeaGapDocs/tutorialforward/">Forward calculation</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialdenoise/">Outlier removal</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialkinematic/">Kinematic array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialstatic/">Static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialmcmcpvg/">MCMC static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialts/">Line fitting for time-series</a> </ul> <li><a href="/SeaGapDocs/others/">Others</a> </ul> </nav> </div> <main id=panel  class="slidout-panel slideout-panel-left"> <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">Tutorials</h1> <hr> <div class=franklin-content > <h1 id=kinematic_array_positioning ><a href="#kinematic_array_positioning" class=header-anchor >Kinematic array positioning</a></h1> <p>In SeaGap, the kinematic positioning function &#40;<code>pos_array_each</code>&#41; based on <a href="https://earth-planets-space.springeropen.com/articles/10.1186/BF03351996">Kido et al. &#40;2006&#41;</a> and <a href="https://earth-planets-space.springeropen.com/articles/10.1186/BF03352785">Kido et al. &#40;2008&#41;</a> is provided. A kinematic array position can be estimated for each shot group by Gauss-Newton method.</p> <div class=franklin-toc ><ol><li><a href="#input_data">Input data</a><li><a href="#estimation">Estimation</a><li><a href="#visualization">Visualization </a></ol></div> <h2 id=input_data ><a href="#input_data" class=header-anchor >Input data</a></h2> <p>To perform <code>pos_array_each</code>, you have to prepare four input files denoted in <a href="/SeaGapDocs/dataformat/">Dataformat</a>: &quot;tr-ant.inp&quot;. &quot;pxp-ini.xyh&quot;, &quot;ss&#95;prof.zv&quot;, and &quot;obsdata.inp&quot;. Outliers in &quot;obsdata.inp&quot; should be removed in advance; SeaGap includes a simple <a href="/SeaGapDocs/tutorialdenoise/">outlier removal</a> function.</p> <p>In &quot;obsdata.inp&quot;, you have to write the shot group number.</p> <div class=important >&#36; head obsdata.inp</div> <pre><code class="plaintext hljs">1 3.932951 500664917.000000 328.924820 253.690718 28.230250 -52.76000 -1.08760 -4.84800 500664923.030102 332.595337 256.316298 27.751791 -52.68875 -0.89626 1.21533 3
3 4.357953 500664917.000000 328.924820 253.690718 28.230250 -52.76000 -1.08760 -4.84800 500664923.455105 332.635629 256.224942 28.223725 -52.71458 -1.45692 -0.33433 3
4 4.113388 500664917.000000 328.924820 253.690718 28.230250 -52.76000 -1.08760 -4.84800 500664923.210540 332.613304 256.277211 27.956819 -52.70038 -1.13751 0.54746 3
1 3.915718 500664977.000000 373.035589 269.760505 26.578150 -67.98040 0.74000 1.68840 500664983.012870 378.677857 271.831665 27.544478 -71.14971 -1.07657 -0.09575 4
3 4.385641 500664977.000000 373.035589 269.760505 26.578150 -67.98040 0.74000 1.68840 500664983.482792 379.056560 272.006605 28.023320 -71.32463 -1.99330 0.01337 4
4 4.107478 500664977.000000 373.035589 269.760505 26.578150 -67.98040 0.74000 1.68840 500664983.204630 378.829072 271.903686 27.752693 -71.21717 -1.48302 -0.05251 4
1 3.891855 500665037.000000 433.056625 301.790116 28.075250 -102.24360 -2.02200 -0.07680 500665042.989008 438.912558 305.954410 27.484275 -104.12427 -1.15657 0.14795 5
3 4.431185 500665037.000000 433.056625 301.790116 28.075250 -102.24360 -2.02200 -0.07680 500665043.528337 439.559126 306.314161 27.384643 -104.49262 -0.77367 -0.75093 5
4 4.106340 500665037.000000 433.056625 301.790116 28.075250 -102.24360 -2.02200 -0.07680 500665043.203493 439.166251 306.086586 27.453858 -104.25092 -1.02985 -0.21190 5
1 3.864128 500665097.000000 498.198875 338.484885 27.308750 -100.24200 -0.04560 1.64200 500665102.961280 506.226386 341.946760 29.059762 -99.11188 -3.00132 1.92119 6</code></pre> <p>The last column shows the shot group number. <code>pos_array_each&#40;&#41;</code> estimates a horizontal array position using the data with each shot number if number of the observational data lines are more than <code>NR</code> &#40;<code>NR&#61;3</code> in default, but you cannot assign <code>NR</code>&lt;2 because number of unknown paramters is 3&#41;. The detailed format of &quot;obsdata.inp&quot; are shown in <a href="/SeaGapDocs/dataformat/">Dataformat</a>.</p> <h2 id=estimation ><a href="#estimation" class=header-anchor >Estimation</a></h2> <p>You can simply perform <code>pos_array_each</code> as following: </p> <pre><code class="julia hljs">lat=<span class=hljs-number >36.15753</span>; XDUCER_DEPTH=<span class=hljs-number >5.0</span>
SeaGap.pos_array_each(lat,XDUCER_DEPTH)</code></pre> <p>The input files are <code>fn1</code>, <code>fn2</code>, <code>fn3</code>, and <code>fn4</code>; they correspond to &quot;tr-ant.inp&quot;. &quot;pxp-ini.xyh&quot;, &quot;ss&#95;prof.zv&quot;, and &quot;obsdata.inp&quot; in default.</p> <p>Then, after performing, you obtained a log file as <code>fno0</code> &#40;<code>fno0&#61;&quot;log.txt&quot;</code> in default&#41;, a position file <code>fno1</code> &#40;<code>fno1&#61;&quot;array_each.out&quot;</code> in default&#41;, and a data misfit file <code>fno2</code> &#40;<code>fno2&#61;&quot;residual_each.out&quot;</code>&#41;.</p> <p>&quot;array&#95;each.out&quot;</p> <ul> <li><p>1: the transmitting time &#91;sec&#93;</p> <li><p>2: number of the used observational data for each shot group</p> <li><p>3: Easting displacement &#91;m&#93;</p> <li><p>4: Northing displacement &#91;m&#93;</p> <li><p>5: NTD &#91;sec&#93;</p> <li><p>6: Std. of Easting disp. &#91;m&#93;</p> <li><p>7: Std. of Northing disp. &#91;m&#93;</p> <li><p>8: Std. of NTD &#91;sec&#93;</p> <li><p>9: the shot group number</p> </ul> <p>Note that 6-8 columns show &quot;Inf&quot; if number of the used observational data is 3.</p> <div class=important >&#36; head array&#95;each.out</div> <pre><code class="plaintext hljs">5.00664917e8 3 0.1453633877852824 -0.09278934666794787 0.001861163617159608 Inf Inf Inf 3
5.00664977e8 3 0.12614038874488606 -0.057422633767672655 0.0018715189289275115 Inf Inf Inf 4
5.00665037e8 3 0.07936571170266186 -0.05687149763887808 0.0018551728738569694 Inf Inf Inf 5
5.00665097e8 3 0.0264715534964957 -0.008771078117542352 0.001847548147532196 Inf Inf Inf 6
5.00665157e8 4 0.04316895253575775 0.023535453720761355 0.001910133990558378 0.00256471661166177 0.0024299635683038513 1.0369446952118624e-6 7
5.00665217e8 4 0.03786988717360014 0.05047262924984068 0.0018880334236326785 0.029162706657460933 0.028602444637499756 1.225134599144191e-5 8
5.00665277e8 4 0.0820308602739349 0.06974247032181959 0.0018764066023373308 0.06451632308678762 0.05953740233678682 2.702672824962262e-5 9
5.00665337e8 3 -0.06495578410464437 0.12644569423179428 0.0018195955053809194 Inf Inf Inf 10
5.00665397e8 4 0.019562081098463194 0.05730593122968437 0.001867836110354499 0.0492365518347607 0.0427912450102088 2.1891838113411593e-5 11
5.00665457e8 4 0.07189823454093269 0.03975598136588962 0.0018583240316095582 0.04355482260295224 0.03805680609681681 1.9584956095819914e-5 12</code></pre> <p>&quot;residual&#95;each.out&quot;</p> <ul> <li><p>1: the transmitted time</p> <li><p>2: the transponder number</p> <li><p>3: misfit &#91;sec&#93;</p> <li><p>4: number of interations</p> <li><p>5: the shot group number</p> <li><p>6: number of the used data</p> </ul> <p>If the number of the used data is 3, the misfits are almost zero.</p> <div class=important >&#36; head -n 16 residual&#95;each.out</div> <pre><code class="plaintext hljs">5.00664917e8 1 1.0842021724855044e-18 3 3 3
5.00664917e8 3 -2.168404344971009e-19 3 3 3
5.00664917e8 4 -2.168404344971009e-18 3 3 3
5.00664977e8 1 1.951563910473908e-18 4 4 3
5.00664977e8 3 -1.951563910473908e-18 4 4 3
5.00664977e8 4 -1.734723475976807e-18 4 4 3
5.00665037e8 1 4.9873299934333204e-18 3 5 3
5.00665037e8 3 -1.1275702593849246e-17 3 5 3
5.00665037e8 4 1.0842021724855044e-18 3 5 3
5.00665097e8 1 1.3010426069826053e-18 3 6 3
5.00665097e8 3 -6.5052130349130266e-18 3 6 3
5.00665097e8 4 6.7220534694101275e-18 3 6 3
5.00665157e8 1 6.248285661649648e-7 3 7 4
5.00665157e8 2 -8.073841889170291e-7 3 7 4
5.00665157e8 3 9.097131878365878e-7 3 7 4
5.00665157e8 4 -7.271575650853908e-7 3 7 4</code></pre> <p>You can change the following inversion criterion values by keyword arguments:</p> <ul> <li><p><code>eps</code>: Convergence criteria &#91;m&#93;, the default is 1.e-4 &#40;each inversion is converged when RMS of difference between the previous and the new solutions of the horizontal array displacements &lt; <code>eps</code>&#41;</p> <li><p><code>ITMAX</code>: Maximum number of interations, the default is 20</p> <li><p><code>delta_pos</code>: Infinitesimal amount of the array positions to calculate the Jacobian matrix, the default is 1.e-4 &#91;m&#93;</p> </ul> <p>For example:</p> <pre><code class="julia hljs">SeaGap.pos_array_each(lat,XDUCER_DEPTH,delta_pos=<span class=hljs-number >1.e-5</span>)</code></pre>
<h2 id=visualization ><a href="#visualization" class=header-anchor >Visualization </a></h2>
<p>If you&#39;d like to plot the array positions in a horizontal map, you can use <code>plot_map_array_each&#40;xrange,yrange; autoscale,fn,fno,show,col_num&#41;</code> function.</p>
<ul>
<li><p>If <code>autoscale&#61;true</code> &#40;default&#41;, the plot range is automatically determined. If <code>autoscale&#61;false</code>, the plot range is fixed by <code>xrange</code> and <code>yrange</code>.</p>

<li><p><code>fn</code> is the input file name: &quot;array&#95;each.out&quot; in default.</p>

<li><p>If <code>show&#61;false</code>, the figure is saved as <code>fno</code> &#40;<code>fno</code> is name of the output figure&#41;. If <code>show&#61;true</code> in REPL, a figure is temporally shown.</p>

<li><p>If <code>col_num&#61;1</code> &#40;default&#41;, the plot is colored by the observation time. If <code>col_num&#61;2</code>, the plot is colored by number of the used observational data. If <code>col_num&#61;0</code>, the plot is colored by blue. </p>

</ul>
<pre><code class="julia hljs">SeaGap.plot_map_array_each((-<span class=hljs-number >0.5</span>,<span class=hljs-number >0.5</span>),(-<span class=hljs-number >0.5</span>,<span class=hljs-number >0.5</span>),autoscale=<span class=hljs-literal >false</span>,fno=<span class=hljs-string >&quot;map_array_each.png&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/map_array_each.png" width=300  height=300 >
    <div style="clear: both"></div>      
  </div>
</div>

<p>If you&#39;d like to plot the array positions in time-series, you can use <code>plot_time_array_each&#40;EW_range,NS_range.ntdrange.autoscale,fn,fno,show&#41;</code> function.</p>
<ul>
<li><p>If <code>autoscale&#61;true</code> &#40;default&#41;, the plot range is automatically determined. If <code>autoscale&#61;false</code>, the plot range of y-componet is fixed by <code>EW_range</code>, <code>NS_range</code>, and <code>ntdrange</code>. The range of x-compoent &#40;Time&#41; is automatically determined in the both cases.</p>

<li><p><code>fn</code> is the input file name: &quot;array&#95;each.out&quot; in default.</p>

<li><p>If <code>show&#61;false</code>, the figure is saved as <code>fno</code> &#40;<code>fno</code> is name of the output figure&#41;. If <code>show&#61;true</code> in REPL, a figure is temporally shown.</p>

</ul>
<pre><code class="julia hljs">SeaGap.plot_time_array_each(fno=<span class=hljs-string >&quot;time_array_each.png&quot;</span>)</code></pre>

<div class=row >
  <div class=container >
    <img src="/SeaGapDocs/assets/time_array_each.png" width=650  height=650 >
    <div style="clear: both"></div>      
  </div>
</div>

<div class=page-foot >
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Fumiaki Tomita. Last modified: January 24, 2023.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>
</div>
  </main> 
  <script src="/SeaGapDocs/libs/vela/metisMenu.min.js"></script>
  <script src="/SeaGapDocs/libs/vela/slideout.min.js"></script>
  
  
    <script src="/SeaGapDocs/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>
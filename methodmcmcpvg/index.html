<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/SeaGapDocs/libs/katex/katex.min.css"> <link rel=stylesheet  href="/SeaGapDocs/libs/highlight/styles/github.min.css"> <link href="/SeaGapDocs/css/franklin.css" rel=stylesheet > <link href="/SeaGapDocs/css/vela.css" rel=stylesheet > <script src="/SeaGapDocs/libs/vela/jquery.min.js"></script> <link rel=icon  href="/SeaGapDocs/assets/favicon.png"> <title>SeaGapDocs</title> <div class="main-nav slideout-menu slideout-menu-left" id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>SeaGap Docs</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/SeaGapDocs/index.html">Home</a> <li><a href="/SeaGapDocs/install/">Installation</a> <li><a href="/SeaGapDocs/dataformat/">Dataformat</a> <li><a href="" class=has-arrow >Methodology</a> <ul> <li><a href="/SeaGapDocs/methodoverview/">Overview</a> </ul> <ul> <li><a href="/SeaGapDocs/methodtt/">Travel-time calculation</a> </ul> <ul> <li><a href="/SeaGapDocs/methodkinematic/">Kinematic array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodstatic/">Static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodsingle/">Individual transponder positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/methodmcmcpvg/">Static array positioning with gradients</a> </ul> <li><a href="" class=has-arrow >Tutorials</a> <ul> <li><a href="/SeaGapDocs/tutorialforward/">Forward calculation</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialdenoise/">Outlier removal</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialkinematic/">Kinematic array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialstatic/">Static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialmcmcpvg/">MCMC static array positioning</a> </ul> <ul> <li><a href="/SeaGapDocs/tutorialts/">Line fitting for time-series</a> </ul> <li><a href="/SeaGapDocs/others/">Others</a> </ul> </nav> </div> <main id=panel  class="slidout-panel slideout-panel-left"> <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">Methodology</h1> <hr> <div class=franklin-content > <h1 id=static_array_positioning_with_gradients ><a href="#static_array_positioning_with_gradients" class=header-anchor >Static array positioning with gradients</a></h1> <p>As discussed in various studies &#40;e.g., <a href="https://earth-planets-space.springeropen.com/articles/10.1186/BF03352027">Kido &#40;2007&#41;</a>, <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2018JB017135">Honsho et al. &#40;2019&#41;</a>&#41;, horizontal array displacements has trade-off relationship with horizontal heterogenity of a sound speed structure. Recent GNSS-A studies has considered a horizontally sloping sound speed structure &#40;<a href="https://link.springer.com/article/10.1007/s11001-018-9362-7">Yokota et al. &#40;2018&#41;</a>, <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2017GL072918">Yasuda et al. &#40;2017&#41;</a>, <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2018JB017135">Honsho et al. &#40;2019&#41;</a>&#41;. Here, a static array positioning method considering a horizontally sloping sound speed structure &#40;<a href="https://earth-planets-space.springeropen.com/articles/10.1186/s40623-022-01740-0">Tomita &amp; Kido, 2022</a>&#41; is simply introduced. </p> <p>Effect of a horizontally sloping sound speed structure on a travel-time is expressed by two component: shallow and deep gradients &#40;e.g., <a href="https://link.springer.com/article/10.1007/s11001-018-9362-7">Yokota et al., 2018</a>&#41;.</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msubsup><mi>T</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow><mrow><mi mathvariant=normal >o</mi><mi mathvariant=normal >b</mi><mi mathvariant=normal >s</mi></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msup><mi>T</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi mathvariant=bold >p</mi><mi>k</mi></msub><mo>+</mo><mstyle mathcolor=red ><mi>δ</mi><mi mathvariant=bold >p</mi><mstyle mathcolor=black ><mo separator=true >,</mo><mi mathvariant=bold >u</mi><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo separator=true >,</mo><msub><mi mathvariant=bold >b</mi><mn>0</mn></msub><mo fence=true  mathcolor=black >)</mo></mrow><mo separator=true >,</mo><msub><mi>v</mi><mn>0</mn></msub></mstyle></mstyle><mo fence=true  mathcolor=black >)</mo></mrow><mo>+</mo><mstyle mathcolor=red ><msub><mi>C</mi><mn>0</mn></msub><mstyle mathcolor=black ><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo fence=true  mathcolor=black >)</mo></mrow><mo>+</mo><mstyle mathcolor=red ><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub><mstyle mathcolor=black ><msup><mi mathvariant=bold >u</mi><mrow><mi mathvariant=normal >h</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >r</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo fence=true  mathcolor=black >)</mo></mrow><mo>+</mo><mstyle mathcolor=red ><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >d</mi></msub><mstyle mathcolor=black ><msub><mi mathvariant=bold >h</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex"> \frac{1}{M\left(\xi_{n,k}\right)} T_{n,k}^{\mathrm{obs}}=\frac{1}{M\left(\xi_{n,k}\right)} {T}^{\mathrm{cal}}\left(\mathbf{p}_k+\color{red}\delta \mathbf{p}\color{black}, \mathbf{u}\left(t_{n},{\bf b}_0\right), v_0\right)+\color{red}C_0\color{black}\left(t_{n}\right) +\color{red}\mathbf{g}_{\mathrm{s}}\color{black} \mathbf{u}^{\mathrm{hor}}\left(t_{n}\right)+\color{red}\mathbf{g}_{\mathrm{d}}\color{black} \mathbf{h}_{n,k} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.2935em;vertical-align:-0.9721em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">obs</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3831em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.2935em;vertical-align:-0.9721em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;color:red;">δ</span><span class="mord mathbf" style="color:red;">p</span><span class=mpunct  style="color:black;">,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathbf" style="color:black;">u</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner  style="color:black;"><span class="mopen delimcenter" style="color:black;top:0em;"><span style="color:black;">(</span></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="color:black;">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct  style="color:black;">,</span><span class=mspace  style="color:black;margin-right:0.1667em;"></span><span class=mord  style="color:black;"><span class=mord  style="color:black;"><span class=mord  style="color:black;"><span class="mord mathbf" style="color:black;">b</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="color:black;top:0em;"><span style="color:black;">)</span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct  style="color:black;">,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="margin-right:0.03588em;color:black;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="color:black;top:0em;"><span style="color:black;">)</span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord  style="color:red;"><span class="mord mathnormal" style="margin-right:0.07153em;color:red;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner  style="color:black;"><span class="mopen delimcenter" style="color:black;top:0em;"><span style="color:black;">(</span></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="color:black;">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="color:black;top:0em;"><span style="color:black;">)</span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin  style="color:black;">+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.1491em;vertical-align:-0.25em;"></span><span class=mord  style="color:red;"><span class="mord mathbf" style="margin-right:0.01597em;color:red;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mathrm mtight" style="color:red;">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord  style="color:black;"><span class="mord mathbf" style="color:black;">u</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathrm mtight" style="color:black;">hor</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner  style="color:black;"><span class="mopen delimcenter" style="color:black;top:0em;"><span style="color:black;">(</span></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="color:black;">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="color:black;top:0em;"><span style="color:black;">)</span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin  style="color:black;">+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.9805em;vertical-align:-0.2861em;"></span><span class=mord  style="color:red;"><span class="mord mathbf" style="margin-right:0.01597em;color:red;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mathrm mtight" style="color:red;">d</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord  style="color:black;"><span class="mord mathbf" style="color:black;">h</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span><span class="mpunct mtight" style="color:black;">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;color:black;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> <p>with</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi mathvariant=bold >h</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo>=</mo><mrow><mo fence=true >(</mo><mi>tan</mi><mo>⁡</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mi>sin</mi><mo>⁡</mo><msub><mi>ϕ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo separator=true >,</mo><mi>tan</mi><mo>⁡</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mi>cos</mi><mo>⁡</mo><msub><mi>ϕ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow><annotation encoding="application/x-tex"> \mathbf{h}_{n,k}=\left(\tan \xi_{n,k} \sin \phi_{n,k}, \tan \xi_{n,k} \cos \phi_{n,k}\right) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.9805em;vertical-align:-0.2861em;"></span><span class=mord ><span class="mord mathbf">h</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.0361em;vertical-align:-0.2861em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mop >tan</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mop >sin</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">ϕ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mop >tan</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mop >cos</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">ϕ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{g}_{\mathrm{s}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6389em;vertical-align:-0.1944em;"></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the shallow gradient, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >d</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{g}_{\mathrm{d}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6389em;vertical-align:-0.1944em;"></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">d</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the deep gradient; they individually have EW and NS components. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ξ</mi></mrow><annotation encoding="application/x-tex">\xi</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span></span></span></span> is a shot angle, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span></span></span></span> is an azimuth. They originally have time flcuatuation, but it is assumed o be constant during a campaign for simplicity. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">C_0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is NTD corresponding to the average sound speed fluctuation. The other terms are same with the previous pages &#40;<a href="/SeaGapDocs/methodstatic/">static array positioning</a>.</p> <p>As long as using single sea-surface platform, the NTD &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">C_0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#41; and the effect of the shallow gradient &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub><msup><mi mathvariant=bold >u</mi><mrow><mi mathvariant=normal >h</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >r</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo fence=true >)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{g}_{\mathrm{s}}\mathbf{u}^{\mathrm{hor}}\left(t_{n}\right)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0991em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf">u</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">hor</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>&#41; are strongly trade-off, This means that the effect of the shallow gradient does not strongly affect horizontal array displacements by the single sea-surface platform case. Considering this, we simultaneously model the NTD and the effect of the shallow gradient by the superposition of the 3d B-spline functions:</p> <p><strong>&lt; Observation Equation &#40;0&#41; &gt;</strong></p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msubsup><mi>T</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow><mrow><mi mathvariant=normal >o</mi><mi mathvariant=normal >b</mi><mi mathvariant=normal >s</mi></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msup><mi>T</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi mathvariant=bold >p</mi><mi>k</mi></msub><mo>+</mo><mstyle mathcolor=red ><mi>δ</mi><mi mathvariant=bold >p</mi><mstyle mathcolor=black ><mo separator=true >,</mo><mi mathvariant=bold >u</mi><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo separator=true >,</mo><msub><mi mathvariant=bold >b</mi><mn>0</mn></msub><mo fence=true  mathcolor=black >)</mo></mrow><mo separator=true >,</mo><msub><mi>v</mi><mn>0</mn></msub></mstyle></mstyle><mo fence=true  mathcolor=black >)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mstyle mathcolor=red ><msub><mi>c</mi><mi>j</mi></msub><mstyle mathcolor=black ><msub><mi mathvariant=normal >Φ</mi><mi>j</mi></msub><mo stretchy=false >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy=false >)</mo><mo>+</mo><mstyle mathcolor=red ><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >d</mi></msub><mstyle mathcolor=black ><msub><mi mathvariant=bold >h</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex"> \frac{1}{M\left(\xi_{n,k}\right)} T_{n,k}^{\mathrm{obs}}=\frac{1}{M\left(\xi_{n,k}\right)} {T}^{\mathrm{cal}}\left(\mathbf{p}_k+\color{red}\delta \mathbf{p}\color{black}, \mathbf{u}\left(t_{n},{\bf b}_0\right), v_0\right)+\sum_{j=1}^{J}\color{red}c_j\color{black}\Phi_j(t_n)+\color{red}\mathbf{g}_{\mathrm{d}}\color{black} \mathbf{h}_{n,k} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.2935em;vertical-align:-0.9721em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">obs</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3831em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.2935em;vertical-align:-0.9721em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;color:red;">δ</span><span class="mord mathbf" style="color:red;">p</span><span class=mpunct  style="color:black;">,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathbf" style="color:black;">u</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner  style="color:black;"><span class="mopen delimcenter" style="color:black;top:0em;"><span style="color:black;">(</span></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="color:black;">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct  style="color:black;">,</span><span class=mspace  style="color:black;margin-right:0.1667em;"></span><span class=mord  style="color:black;"><span class=mord  style="color:black;"><span class=mord  style="color:black;"><span class="mord mathbf" style="color:black;">b</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="color:black;top:0em;"><span style="color:black;">)</span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct  style="color:black;">,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="margin-right:0.03588em;color:black;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="color:black;top:0em;"><span style="color:black;">)</span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:3.2421em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.4138em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord  style="color:red;"><span class="mord mathnormal" style="color:red;">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mathnormal mtight" style="margin-right:0.05724em;color:red;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mord  style="color:black;"><span class=mord  style="color:black;">Φ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mathnormal mtight" style="margin-right:0.05724em;color:black;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mopen  style="color:black;">(</span><span class=mord  style="color:black;"><span class="mord mathnormal" style="color:black;">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose  style="color:black;">)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin  style="color:black;">+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.9805em;vertical-align:-0.2861em;"></span><span class=mord  style="color:red;"><span class="mord mathbf" style="margin-right:0.01597em;color:red;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mathrm mtight" style="color:red;">d</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord  style="color:black;"><span class="mord mathbf" style="color:black;">h</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span><span class="mpunct mtight" style="color:black;">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;color:black;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> <p>According to the observation equation &#40;0&#41;, we can model the sound speed gradient straucture by estimating EW and NS components of the deep gradient &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >d</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{g}_{\mathrm{d}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6389em;vertical-align:-0.1944em;"></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">d</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#41; in addition to the array position and the 3d B-splined NTDs. You can perform this optimization through Gauss-Newton method by <code>pos_array_pvg&#40;&#41;</code>.</p> <p>However, this optimization is quite unstable except acoustic data obtained from spatially well-distributed sea-surface platform &#40;for example, the data of Japan Coast Guard: <a href="https://www.frontiersin.org/articles/10.3389/feart.2020.597532/full">Watanabe et al., 2020</a>&#41; or obtained at a site with a bunch of seafloor transponders &#40;for example, multi-angled transponders: <a href="https://earth-planets-space.springeropen.com/articles/10.1186/s40623-019-1082-y">Tomita et al., 2019</a>&#41;.</p> <p>To stabilize this optimization, Honsho et al. &#40;2019&#41; provided a further constaint: the sound speed gradient uniformly exsits from the sea-surface to a certain depth &#40;gradient depth <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>&#41;. This assumption menas that the deep gradient has a linear relationship with the shallow gradient, and its linear coeffient is the gradient depth as:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >d</mi></msub><mo>=</mo><mfrac><mi>D</mi><mn>2</mn></mfrac><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub></mrow><annotation encoding="application/x-tex"> {\bf g}_{\rm d}=\frac{D}{2}{\bf g}_{\rm s} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6389em;vertical-align:-0.1944em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">d</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.0463em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3603em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> <p>Thus, if you somehow obtain the shallow depth, you can estimate the deep gradient by optimizing only the gradient depth:</p> <p><strong>&lt; Observation Equation &#40;1&#41; &gt;</strong></p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msubsup><mi>T</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow><mrow><mi mathvariant=normal >o</mi><mi mathvariant=normal >b</mi><mi mathvariant=normal >s</mi></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msup><mi>T</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi mathvariant=bold >p</mi><mi>k</mi></msub><mo>+</mo><mstyle mathcolor=red ><mi>δ</mi><mi mathvariant=bold >p</mi><mstyle mathcolor=black ><mo separator=true >,</mo><mi mathvariant=bold >u</mi><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo separator=true >,</mo><msub><mi mathvariant=bold >b</mi><mn>0</mn></msub><mo fence=true  mathcolor=black >)</mo></mrow><mo separator=true >,</mo><msub><mi>v</mi><mn>0</mn></msub></mstyle></mstyle><mo fence=true  mathcolor=black >)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mstyle mathcolor=red ><msub><mi>c</mi><mi>j</mi></msub><mstyle mathcolor=black ><msub><mi mathvariant=normal >Φ</mi><mi>j</mi></msub><mo stretchy=false >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy=false >)</mo><mo>+</mo><mfrac><mstyle mathcolor=red ><mi>D</mi><mstyle mathcolor=black ></mstyle></mstyle><mn>2</mn></mfrac><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub><msub><mi mathvariant=bold >h</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub></mstyle></mstyle></mrow><annotation encoding="application/x-tex"> \frac{1}{M\left(\xi_{n,k}\right)} T_{n,k}^{\mathrm{obs}}=\frac{1}{M\left(\xi_{n,k}\right)} {T}^{\mathrm{cal}}\left(\mathbf{p}_k+\color{red}\delta \mathbf{p}\color{black}, \mathbf{u}\left(t_{n},{\bf b}_0\right), v_0\right)+\sum_{j=1}^{J}\color{red}c_j\color{black}\Phi_j(t_n)+\frac{\color{red}D\color{black}}{2}\mathbf{g}_{\mathrm{s}}\mathbf{h}_{n,k} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.2935em;vertical-align:-0.9721em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">obs</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3831em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.2935em;vertical-align:-0.9721em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;color:red;">δ</span><span class="mord mathbf" style="color:red;">p</span><span class=mpunct  style="color:black;">,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathbf" style="color:black;">u</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner  style="color:black;"><span class="mopen delimcenter" style="color:black;top:0em;"><span style="color:black;">(</span></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="color:black;">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct  style="color:black;">,</span><span class=mspace  style="color:black;margin-right:0.1667em;"></span><span class=mord  style="color:black;"><span class=mord  style="color:black;"><span class=mord  style="color:black;"><span class="mord mathbf" style="color:black;">b</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="color:black;top:0em;"><span style="color:black;">)</span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct  style="color:black;">,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="margin-right:0.03588em;color:black;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="color:black;top:0em;"><span style="color:black;">)</span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:3.2421em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.4138em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord  style="color:red;"><span class="mord mathnormal" style="color:red;">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mathnormal mtight" style="margin-right:0.05724em;color:red;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mord  style="color:black;"><span class=mord  style="color:black;">Φ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mathnormal mtight" style="margin-right:0.05724em;color:black;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mopen  style="color:black;">(</span><span class=mord  style="color:black;"><span class="mord mathnormal" style="color:black;">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose  style="color:black;">)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin  style="color:black;">+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:2.0463em;vertical-align:-0.686em;"></span><span class=mord  style="color:black;"><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3603em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord  style="color:black;"><span class=mord  style="color:black;">2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="color:black;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="margin-right:0.02778em;color:red;">D</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord  style="color:black;"><span class="mord mathbf" style="margin-right:0.01597em;color:black;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathrm mtight" style="color:black;">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord  style="color:black;"><span class="mord mathbf" style="color:black;">h</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span><span class="mpunct mtight" style="color:black;">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;color:black;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> <p>Meanwhile, because of the trade-off relationship between the temporal fluctuation of NTD and the shallow gradient, it is difficult to grasp the shallow gradient. Separation of them can be roughly conducted by modeling long-term component of the temporal fluctuation of NTD &#40;e.g., <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2018JB017135">Honsho et al., 2019</a>&#41;. Here, we model the long-term NTD as the 4th polynomial functions:</p> <p><strong>&lt; Observation Equation &#40;2&#41; &gt;</strong></p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msubsup><mi>T</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow><mrow><mi mathvariant=normal >o</mi><mi mathvariant=normal >b</mi><mi mathvariant=normal >s</mi></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><mi>M</mi><mrow><mo fence=true >(</mo><msub><mi>ξ</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub><mo fence=true >)</mo></mrow></mrow></mfrac><msup><mi>T</mi><mrow><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi mathvariant=bold >p</mi><mi>k</mi></msub><mo>+</mo><mi>δ</mi><mi mathvariant=bold >p</mi><mo separator=true >,</mo><mi mathvariant=bold >u</mi><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo separator=true >,</mo><msub><mi mathvariant=bold >b</mi><mn>0</mn></msub><mo fence=true >)</mo></mrow><mo separator=true >,</mo><msub><mi>v</mi><mn>0</mn></msub><mo fence=true >)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mn>4</mn></munderover><mstyle mathcolor=red ><msub><mi>γ</mi><mi>m</mi></msub><mstyle mathcolor=black ><msubsup><mi>t</mi><mi>n</mi><mi>m</mi></msubsup><mo>+</mo><mstyle mathcolor=red ><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub><mstyle mathcolor=black ><msup><mi mathvariant=bold >u</mi><mrow><mi mathvariant=normal >h</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >r</mi></mrow></msup><mrow><mo fence=true >(</mo><msub><mi>t</mi><mi>n</mi></msub><mo fence=true  mathcolor=black >)</mo></mrow><mo>+</mo><mfrac><mi>D</mi><mn>2</mn></mfrac><mstyle mathcolor=red ><msub><mi mathvariant=bold >g</mi><mi mathvariant=normal >s</mi></msub><mstyle mathcolor=black ><msub><mi mathvariant=bold >h</mi><mrow><mi>n</mi><mo separator=true >,</mo><mi>k</mi></mrow></msub></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex"> \frac{1}{M\left(\xi_{n,k}\right)} T_{n,k}^{\mathrm{obs}}=\frac{1}{M\left(\xi_{n,k}\right)} {T}^{\mathrm{cal}}\left(\mathbf{p}_k+\delta \mathbf{p}, \mathbf{u}\left(t_{n},{\bf b}_0\right), v_0\right)+ \sum_{m=0}^{4} \color{red}\gamma_{m}\color{black}t^m_n + \color{red}\mathbf{g}_{\mathrm{s}}\color{black} \mathbf{u}^{\mathrm{hor}}\left(t_{n}\right) +\frac{D}{2}\color{red}\mathbf{g}_{\mathrm{s}}\color{black}\mathbf{h}_{n,k} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.2935em;vertical-align:-0.9721em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">obs</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3831em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.2935em;vertical-align:-0.9721em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">cal</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord mathbf">p</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathbf">u</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord mathbf">b</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:3.0682em;vertical-align:-1.2671em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8011em;"><span style="top:-1.8829em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.2671em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord  style="color:red;"><span class="mord mathnormal" style="margin-right:0.05556em;color:red;">γ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mathnormal mtight" style="color:red;">m</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="color:black;">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin  style="color:black;">+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.1491em;vertical-align:-0.25em;"></span><span class=mord  style="color:red;"><span class="mord mathbf" style="margin-right:0.01597em;color:red;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mathrm mtight" style="color:red;">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord  style="color:black;"><span class="mord mathbf" style="color:black;">u</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathrm mtight" style="color:black;">hor</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner  style="color:black;"><span class="mopen delimcenter" style="color:black;top:0em;"><span style="color:black;">(</span></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="color:black;">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="color:black;top:0em;"><span style="color:black;">)</span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin  style="color:black;">+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:2.0463em;vertical-align:-0.686em;"></span><span class=mord  style="color:black;"><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3603em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord  style="color:black;"><span class=mord  style="color:black;">2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="color:black;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord  style="color:black;"><span class="mord mathnormal" style="margin-right:0.02778em;color:black;">D</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord  style="color:red;"><span class="mord mathbf" style="margin-right:0.01597em;color:red;">g</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mathrm mtight" style="color:red;">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord  style="color:black;"><span class="mord mathbf" style="color:black;">h</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">n</span><span class="mpunct mtight" style="color:black;">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;color:black;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> <p>Iterative optimization of the observation equations &#40;1&#41; and &#40;2&#41;, note that the red terms are the unknown parameters for each equation, can conduct relatively stabler analysis under the sound speed gradient than the observation equation &#40;0&#41; &#40;<a href="https://earth-planets-space.springeropen.com/articles/10.1186/s40623-022-01740-0">Tomita &amp; Kido, 2022</a>&#41;. Moreover, the gradient depth is limited from the sea-surface &#40;zero&#41; to the seafloor. To flexibly inculude the limitation, we employ a MCMC technique to optimize the observation equations &#40;1&#41; and &#40;2&#41; <code>pos_array_mcmcpvg&#40;&#41;</code>.</p> <p>To perform <code>pos_array_mcmcpvg&#40;&#41;</code>, we initially obtain solutions by the static array positioning with horizontally stratified sound speed structure <code>pos_array_all&#40;&#41;</code>. Using the solutions of <code>pos_array_all&#40;&#41;</code> as the initial values, <code>pos_array_mcmcpvg&#40;&#41;</code> optimize the observation equations &#40;1&#41; and &#40;2&#41; for odd and even MCMC loops, respectively. Note that we also optimize a scaling factor for each observation equations; the scaling factors express the observational error of each equation and balance the weights of the observation equations &#40;e.g., <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2020JB020991">Tomita et al., 2021</a>&#41;. </p> <p>The details of this MCMC optimization are shown in <a href="https://earth-planets-space.springeropen.com/articles/10.1186/s40623-022-01740-0">Tomita &amp; Kido &#40;2022&#41;</a>.</p> <p>Optionally, SeaGap includes a developing function <code>pos_array_mcmcpvgc&#40;&#41;</code> which add some constraints to <code>pos_array_mcmcpvg&#40;&#41;</code> to obtain solutions more stably. See Tutorials in detail for this developing function. </p> <div class=page-foot > <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Fumiaki Tomita. Last modified: January 26, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </main> <script src="/SeaGapDocs/libs/vela/metisMenu.min.js"></script> <script src="/SeaGapDocs/libs/vela/slideout.min.js"></script> <script src="/SeaGapDocs/libs/highlight/highlight.min.js"></script> <script>hljs.highlightAll();hljs.configure({tabReplace: ' '});</script>